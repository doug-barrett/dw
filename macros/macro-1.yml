fileVersion: 1
id: "1"
macroString: |

  {%- macro even_odd(column) -%}
      CASE WHEN MOD({{ column }}, 2) = 0 THEN 'EVEN' ELSE 'ODD' END
  {%- endmacro %}


  {%- macro date_sk(column) -%}
      TO_NUMBER(TO_CHAR({{ column }}, 'YYYYMMDD'))
  {%- endmacro %}


  {%- macro replacer(column) -%}
      {% set ns = namespace(col=column) %}
      {% for p in parameters.replace %}
          {% set ns.col = ns.col | replace(p.long,  p.short) %}
      {% endfor %}
      {{ ns.col }}
  {%- endmacro %}

  {%- macro sap(col) -%}
      {% set sap_name = parameters.srcMapping.tbl | selectattr('name','equalto',(sources[0].columns | selectattr('id','equalto',column.id) | map(attribute='sourceColumns') | first | map(attribute='node') | map(attribute='name') | first)) | map(attribute='columns') | first | selectattr('sapName','equalto',sources[0].columns | selectattr('id','equalto',column.id) | map(attribute='sourceColumns') | first | map(attribute='column') | map(attribute='name') | first) | map(attribute='simpleName') | first %}
      {% if sap_name | length > 0 %}
          {{ sap_name }}
      {% else %}
          {{ col.name }}
      {% endif %}
  {%- endmacro -%}
name: macro
type: Macro
