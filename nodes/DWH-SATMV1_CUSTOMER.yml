fileVersion: 1
id: 761b565c-0ff3-49d4-acab-e060a5617abe
name: SATMV1_CUSTOMER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: Customer data as defined by TPC-H
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c421b2d4-efdf-45ea-9770-132415163a42
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb58c44d-9573-4352-87a3-b36ac637c605
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 131006eb-06b1-46ec-a4bf-ef933bf2dcff
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: C_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26a21485-b4ba-473f-96f6-e11fcf58db3c
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 500d34c2-db5c-45eb-8e78-8f2fefdc0823
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: C_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e946b7ff-f5f5-4755-95f7-dfb65caf69e6
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe17c461-fd25-46b1-8ddc-a52f3e57b5aa
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db61c6e6-cd8a-429d-8ac5-a89668aa6b99
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91176a08-c622-486d-ac07-8b70ef1706e1
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: C_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93be32b4-f5a6-4491-8708-e77cf0cea069
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b1ce687-e193-4569-94b7-4bc84bd1f98e
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: C_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 126b5a87-b49c-4695-a9a1-b1849cc03175
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b5ea93a-d3c5-4cd4-a362-081117574ab1
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f67c9270-b504-47e2-899b-6f173b86fd67
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a68ae29-f16c-4ad5-9108-2961cb2c16e2
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e88c2c86-490c-4d07-9219-1212b6f59709
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92bc56ef-19aa-40b2-a21e-b7490ba196b1
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: DATETIME
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2cd6a38-62ec-4910-8f3f-85d096e20f38
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec217c21-384e-4059-914b-89ed2a2309cf
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bda4b11b-9ae8-43fb-acf3-5b9483b2884b
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ee4c56d-a50d-4e5c-b4e7-7b42cbc4abb3
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: H_CUSTOMER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30ed9e42-3aec-4ddc-99a1-b6384687b4d6
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d3ffbbf-81d5-46b6-87a1-1f5be49e68c6
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: STRING
        description: ""
        name: S_CUSTOMER_LROC_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ba64dc5-4962-4155-8073-bf9a6ad9bc99
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ecfbd19-ba5e-41cf-bd18-919cab3e67f3
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: STRING
        description: ""
        name: H_NATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b9ccb29-acb0-4532-906f-5dfb7e040f48
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e64237a-307b-43ec-9e7a-905e00a55385
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: STRING
        description: ""
        name: L_CUSTOMER_NATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b96263f5-3596-49af-a43d-dff45cf2e3da
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c55325f6-4a3e-4802-900e-3c41bc9f8ed0
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: STRING
        description: ""
        name: S_CUSTOMER_HROC_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9934201-6c2f-4cd3-a4c9-8eab88c2fc76
                stepCounter: f56ed33f-0da8-4179-bd4f-991871d25914
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8643b029-a12a-4254-aa1a-ce8d417d7ff7
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}", "{{ get_source_ma_keys(delimiter=',') }}"  
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 48e80680-50a6-43e9-b3fd-1d0245fc1fc7
          stepCounter: 761b565c-0ff3-49d4-acab-e060a5617abe
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}", "{{ get_source_ma_keys(delimiter=',') }}"
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATMV0_CUSTOMER
        join:
          joinCondition: FROM {{ ref('DWH', 'SATMV0_CUSTOMER') }} "SATMV0_CUSTOMER"
        name: SATMV1_CUSTOMER
        noLinkRefs: []
  name: SATMV1_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: "333"
  type: sql
  version: 1
type: Node
