fileVersion: 1
id: b6bb859b-db98-4107-a116-791aaec98f4f
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SILVER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests:
          hasNull: true
          isDistinct: true
        columnReference:
          columnCounter: 9e558f5d-a590-4695-a8f5-89ce93afb14b
          stepCounter: b6bb859b-db98-4107-a116-791aaec98f4f
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_CUST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dc0d0f3-e81d-4f5f-821f-a298b9fb43d0
                stepCounter: 3b4d0bf4-e9c5-48cc-a539-2e97f466651f
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 1f7d501d-2c87-4ab4-9c9b-0a8a6945ebea
          stepCounter: b6bb859b-db98-4107-a116-791aaec98f4f
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_NATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a82c237a-274d-498f-9cdd-95628d19597e
                stepCounter: 3b4d0bf4-e9c5-48cc-a539-2e97f466651f
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 55178f9a-322a-45e9-8c6c-b756eefe2c2a
          stepCounter: b6bb859b-db98-4107-a116-791aaec98f4f
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: C_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5017bd1-25d8-492c-a4e3-1646624ccc7c
                stepCounter: 3b4d0bf4-e9c5-48cc-a539-2e97f466651f
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 3358b419-14fa-4a81-853d-8b56529cb0c3
          stepCounter: b6bb859b-db98-4107-a116-791aaec98f4f
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: C_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 730e39a1-092d-4e48-8902-3e68b834a63d
                stepCounter: 3b4d0bf4-e9c5-48cc-a539-2e97f466651f
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 4634b196-d073-4651-8177-e948af20e648
          stepCounter: b6bb859b-db98-4107-a116-791aaec98f4f
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4faa082-a7a2-42a4-a7b9-31de3a0c3873
                stepCounter: 3b4d0bf4-e9c5-48cc-a539-2e97f466651f
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 4827811c-a6c4-4e9b-8c8f-298fe2f370e4
          stepCounter: b6bb859b-db98-4107-a116-791aaec98f4f
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5fcd6a1-9f40-410e-8dc7-54686e61a023
                stepCounter: 3b4d0bf4-e9c5-48cc-a539-2e97f466651f
            transform: ""
      - appliedColumnTests:
          hasNull: true
          isDistinct: false
        columnReference:
          columnCounter: e3016566-233b-4973-a887-310571af89f1
          stepCounter: b6bb859b-db98-4107-a116-791aaec98f4f
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: C_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e29dd49e-9149-4ce3-a93e-f2dabd58bbac
                stepCounter: 3b4d0bf4-e9c5-48cc-a539-2e97f466651f
            transform: UPPER("CUSTOMER"."C_NAME")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 9fe36111-c81a-42f1-a989-c8161cc87ce6
          stepCounter: b6bb859b-db98-4107-a116-791aaec98f4f
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: C_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0963f59-6c0b-4644-b7d3-b6e3575ff004
                stepCounter: 3b4d0bf4-e9c5-48cc-a539-2e97f466651f
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 66c944fd-c5c4-4987-92db-956aa615f422
          stepCounter: b6bb859b-db98-4107-a116-791aaec98f4f
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN "CUSTOMER"."C_ACCTBAL" > 5000 THEN 'HIHG'
              ELSE 'LOW' END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs:
      - hasNull
      - isDistinct
    sourceMapping:
      - aliases:
          CUSTOMER: 3b4d0bf4-e9c5-48cc-a539-2e97f466651f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: BRONZE
            nodeName: CUSTOMER
        join:
          joinCondition: |-
            FROM {{ ref('BRONZE', 'CUSTOMER') }} "CUSTOMER"

            WHERE 1 = 1
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
