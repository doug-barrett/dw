fileVersion: 1
id: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
name: SATV1_SUPPLIER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SILVER
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70872628-4a4d-4164-97dd-b89f1113fe81
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9ce65a7-20a9-42f6-ac01-53ef3b842f7e
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bb06be3-af5a-4517-85e4-493f0f0874e3
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4bf885f-977e-4464-96ca-4a70397552ac
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c38f6a08-b80b-40bb-ad67-b1d6c3fa2b6d
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc4b569b-9799-4166-814a-fcccb2bc7df9
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f8d2605-e3eb-4361-9ef2-d74ffb01e024
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4aebf6ac-76bb-41a2-9e13-c188d2e4591f
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a76bf501-79a1-4d3e-866b-bf34efaf99cd
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 222b66b8-aaaa-412a-9b93-4d0c42bb8f0e
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6abecd5-72db-4a58-8816-9b40c5d00e56
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33cae6cb-ca69-4be3-990c-101d5233ed5b
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a5912d-6241-492e-8436-9df0a387ea68
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ee0db6b-e7b5-4ef1-a31b-dd2be68f1362
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7ca3617-24ab-42bd-bb89-04300f258de5
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18710747-60c8-4b2e-ad72-a06a7de240de
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cac9e004-cd3c-4aa1-8b79-64d6cae8fbc9
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3a06d34-5bb7-40c7-a879-6e9e4536a6d8
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8daf63c4-6acd-48c0-94f1-2ae3da1d7afb
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44a273d3-ddd8-43d2-9043-65ea914ced3e
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a63fd8da-5289-45dc-89f4-84037d9e8895
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3c60f3ca-5d02-4f9d-bc76-2993ab148a2a
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f9c86b6-42fb-4f2f-a61f-405090054bdd
          stepCounter: e0c13a2d-26a9-4db5-b120-6a3adfa4766d
        config: {}
        dataType: STRING
        description: ""
        name: S_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc530cc3-f1bb-4cd0-9781-1cfa775b1d2f
                stepCounter: 953a623c-d89a-4665-b3aa-ae907fcd139a
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          SATV0_SUPPLIER: 953a623c-d89a-4665-b3aa-ae907fcd139a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SILVER
            nodeName: SATV0_SUPPLIER
        join:
          joinCondition: FROM {{ ref('SILVER', 'SATV0_SUPPLIER') }} "SATV0_SUPPLIER"
        name: SATV1_SUPPLIER
        noLinkRefs: []
  name: SATV1_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: DV2:::9
  type: sql
  version: 1
type: Node
