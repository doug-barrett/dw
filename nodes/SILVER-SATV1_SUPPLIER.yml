fileVersion: 1
id: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
name: SATV1_SUPPLIER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SILVER
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2f6d5dd-e95e-4c51-bc67-51fec0fa3fac
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0be11e8-15fd-4c89-bc33-3769e4a93100
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78cc930f-f797-40f1-a80e-ca2b679c4408
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0816b2f5-7249-4929-894b-ac9f93c864fb
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f86112fa-e4b9-4cb0-ab5f-e4a522c445c4
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a9d794b-e32b-4abf-8fe1-5f1ba95c12b4
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f87a1a6a-13b5-4220-9179-439a4292687f
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87b38c6f-1798-4880-b9bf-4538099fccd3
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21e85e1e-33a7-4551-b526-6adaa401b5e0
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2973d50f-c5ae-4ee5-8ffc-4a8d19e6913a
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73371a6c-392a-4320-ab45-9158938cc4f8
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64ae39f9-ab72-463d-86e9-2471522a0e28
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 779655b5-85ce-41d6-9a03-248c7315f47a
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b530720-c917-4d77-b14c-78d5c63b62f6
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dae1bc24-06a3-4ec4-9a00-305b15026fbc
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c80aa7c-2304-4510-b176-521a4c581859
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cfd91a6-b19a-4205-872d-d115801f5995
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: STRING
        description: ""
        name: S_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 740fb592-19b7-451a-9470-d07c48dca825
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce04c96b-31a4-4897-94a9-0272240b37ca
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4642138-9820-477c-8d59-8bf4ce901798
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b515c4af-c052-4a57-887a-630c561f4f28
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24162707-3960-4ca3-9f0f-b7e2337b7dab
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3be5af3d-5903-4814-8afc-f5f472811172
                stepCounter: 943b2c40-cebf-4dfb-b386-604bb708f841
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6379da31-2dc4-470a-8682-0d1e7d3a6cc2
          stepCounter: 989864b9-6ed3-4ff2-804e-81a1e3a05b0f
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SILVER
            nodeName: SATV0_SUPPLIER
        join:
          joinCondition: FROM {{ ref('SILVER', 'SATV0_SUPPLIER') }} "SATV0_SUPPLIER"
        name: SATV1_SUPPLIER
        noLinkRefs: []
  name: SATV1_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: DV2:::9
  type: sql
  version: 1
type: Node
