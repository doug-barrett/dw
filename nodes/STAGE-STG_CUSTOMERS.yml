fileVersion: 1
id: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
name: STG_CUSTOMERS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests:
      - continueOnFailure: true
        description: ""
        name: Test
        runOrder: After
        templateString: |-
          SELECT 1
          FROM {{this}}
          WHERE CUSTOMER_NAME LIKE '%TEST%'
    columns:
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: c8e51a29-4bc2-444d-958a-02a3a49e873e
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: _FIVETRAN_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 386c75c2-06e3-4750-968c-6da2bbd288c6
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: true
          isDistinct: true
        columnReference:
          columnCounter: 68978287-e3d3-4de4-a325-abcd9175bd5d
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9df6cb85-8a42-4ef8-b1ca-2b11e6b30679
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: true
          isDistinct: false
        columnReference:
          columnCounter: 3e14d820-ff07-4fe7-a03e-fe80bdd766ad
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: The customers name
        name: CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12a4089f-2dd0-481c-877f-2f2eb63f6013
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."CUSTOMER_NAME")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 0ad65271-0cbd-46a7-abb6-bc1fd41db805
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: NUMBER(38,0)
        description: This is blahj
        name: LOYALTY_SEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bc35f23-8b53-497f-8b0b-edbcfc11aabd
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 256966bc-074a-42fe-b5f6-e52433a01a27
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: NUMBER(11,0)
        description: ""
        name: TAX_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fdc804a-7f73-470d-a48e-2cea383a4e36
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 44522c62-7432-4a0b-9ea9-68e1ec9fcbcf
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: TAX_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 529a6454-c1ed-4ffb-bb78-738eadc6a657
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."TAX_CODE")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: aebb48e6-77fc-48d2-9e1f-825c1da85a27
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a9974d9-2934-4e40-a98e-6c1e3374a8ff
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."NUMBER")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: d758aec1-bad6-4b37-b62c-8125fd20b91a
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8083ac9-167a-4db0-b7d5-04a257f07549
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."UNIT")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 000c7b19-b356-4ad7-8caa-494c63ad1b7c
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: STREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55fe2185-a54e-459c-a8b1-f875a4ccb6b9
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."STREET")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: af8ed266-b7de-4078-be11-318591cd23f7
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc01e6f4-775c-4d61-9d01-b8acf294c933
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."CITY")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 0d4bc53b-d9d8-45de-8c4c-99966ef78ee3
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4787482-239f-4ce6-8eb3-6a3baa11e361
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."REGION")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: cf3de0f6-7f1b-4d6c-a178-0daee5746c00
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19e9886a-db3f-449d-823b-2c598aab2892
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."DISTRICT")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 305dcc18-1ecc-411c-b814-b9a4b27f8973
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8312e3b-cb4c-437d-9245-78aa4714d18e
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."STATE")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 0851d5ab-7adb-48a5-b839-b0156b28fa35
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: POSTCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b68ce1d2-f039-455d-8acb-e6530768e91f
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: UPPER("CUSTOMERS"."POSTCODE")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: b9bcad24-fffc-4797-b0a5-3c0f323c9ac2
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: LAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc328318-bbdd-4588-b325-07720a86e5f6
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: a1cc1f25-95bd-40ab-80fa-65f437cec936
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: LON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51c5c596-e402-4725-826c-1ffdad537cb1
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: cda718fe-58fc-4fe6-9adb-d08e0fcb5142
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: STRING
        description: ""
        name: SHIP_TO_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a60786b2-ae2e-480f-99da-b00c53e284b2
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 097a78b9-3502-4939-a154-0fd6960ad3f9
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: NUMBER(5,1)
        description: ""
        name: UNITS_PURCHASED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba236f19-8168-4a29-8a18-db126bca1668
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: e7e8a376-6e56-43bf-951a-4ea800c5474f
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: VALID_FROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c1f015e-7d1d-4d76-ad1a-0eab2d0f871a
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 37cf0a02-8636-4cd5-b8ca-6ec6d83c3f62
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: NUMBER(12,1)
        description: ""
        name: VALID_TO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e59eab6-0c21-44e0-b1dd-e7cb2db2251c
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 535115ed-a256-4071-8f44-392e69f9c169
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: BOOLEAN
        description: ""
        name: _FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93359722-00e7-472b-843c-7bf477dda128
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: bd8bb4c5-fea0-4a38-a177-29dce2f068da
          stepCounter: 9bf73c1b-f7e2-4045-83a6-8397adb4e7e8
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecdac188-8ceb-443b-b12f-2e172acd1be8
                stepCounter: 8538a0fe-54b6-413c-8531-37d7a1241c6b
            transform: ""
    cteString: ""
    enabledColumnTestIDs:
      - isDistinct
      - hasNull
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SRC_FIVETRAN_RETAIL
            nodeName: CUSTOMERS
        join:
          joinCondition: |-
            FROM {{ ref('SRC_FIVETRAN_RETAIL', 'CUSTOMERS') }} "CUSTOMERS"
            WHERE 1 = 1
            GROUP BY ALL 
        name: STG_CUSTOMERS
        noLinkRefs: []
  name: STG_CUSTOMERS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
