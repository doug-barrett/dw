fileVersion: 1
id: 35b27673-35b1-435c-87fa-9c7d11dfee83
name: STG_SUPPLIER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SILVER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d5937d5-7c3f-4174-ad14-7257ebb0b92a
          stepCounter: 35b27673-35b1-435c-87fa-9c7d11dfee83
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e4ef188-78c5-4952-83b3-778aca211b8c
                stepCounter: a57b12ae-0886-486b-b3e0-7d86344350ea
            transform: UPPER("SUPPLIER"."S_NAME")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1994a608-a3fc-42bf-aefc-33deecb3e53d
          stepCounter: 35b27673-35b1-435c-87fa-9c7d11dfee83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ddd808b-39ff-422a-bea4-7f994547f082
                stepCounter: a57b12ae-0886-486b-b3e0-7d86344350ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d555fa33-228d-49cc-b0ec-c3178547398a
          stepCounter: 35b27673-35b1-435c-87fa-9c7d11dfee83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 586f170f-3fce-4105-b09b-2d2063defcad
                stepCounter: a57b12ae-0886-486b-b3e0-7d86344350ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a9a08b2-5981-46ae-a943-96fec3cd25f4
          stepCounter: 35b27673-35b1-435c-87fa-9c7d11dfee83
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b893532a-e3b7-4122-8f9f-d705bd4510bc
                stepCounter: a57b12ae-0886-486b-b3e0-7d86344350ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baecdaf4-39a2-40bc-82d4-7bfe8d5e8197
          stepCounter: 35b27673-35b1-435c-87fa-9c7d11dfee83
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 245ca003-2be4-46af-8193-e8c30b486c8b
                stepCounter: a57b12ae-0886-486b-b3e0-7d86344350ea
            transform: UPPER("SUPPLIER"."S_ADDRESS")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e08fecdd-272d-42e9-96ed-dd8854f7ae0c
          stepCounter: 35b27673-35b1-435c-87fa-9c7d11dfee83
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0026bc4f-1bfa-4962-9f02-54b1c04aab0a
                stepCounter: a57b12ae-0886-486b-b3e0-7d86344350ea
            transform: UPPER("SUPPLIER"."S_COMMENT")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cbb1950-df33-48a6-ba38-72f787e1b685
          stepCounter: 35b27673-35b1-435c-87fa-9c7d11dfee83
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a9c087a-364a-46ea-80f8-1676b878cd20
                stepCounter: a57b12ae-0886-486b-b3e0-7d86344350ea
            transform: UPPER("SUPPLIER"."S_PHONE")
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 38e54b4e-14e9-449a-b388-a171ae11fdb1
          stepCounter: 35b27673-35b1-435c-87fa-9c7d11dfee83
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: S_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN "SUPPLIER"."S_ACCTBAL" > 5000 THEN 'HIGH' 
              ELSE 'LOW'
              END || ' - ' || "SUPPLIER"."S_COMMENT"
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8e78d71-db9e-4976-a3b7-4eb1b64c1dd9
          stepCounter: 35b27673-35b1-435c-87fa-9c7d11dfee83
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: NATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92e69d5f-502b-460a-b85e-ede2d26b831d
                stepCounter: 895d817e-1776-46b1-840f-77198294ae43
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          NATION: 895d817e-1776-46b1-840f-77198294ae43
          SUPPLIER: a57b12ae-0886-486b-b3e0-7d86344350ea
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: BRONZE
            nodeName: NATION
          - locationName: BRONZE
            nodeName: SUPPLIER
        join:
          joinCondition: |-
            FROM {{ ref('BRONZE', 'SUPPLIER') }} "SUPPLIER"
            INNER JOIN {{ ref('BRONZE', 'NATION') }} "NATION"
            ON "SUPPLIER"."S_NATION_ID" = "NATION"."N_NATION_ID"
        name: STG_SUPPLIER
        noLinkRefs: []
  name: STG_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
