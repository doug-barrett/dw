fileVersion: 1
id: 6f82eb9d-8acc-48be-a450-9fd98134cabc
name: STG_CUSTOMERS1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 344a6f9a-257f-404e-9ca5-1fa636e17d2c
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: _FIVETRAN_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d6fa708-5faa-429f-9d4c-d8596258bf17
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82d8c389-1c2d-45b1-baa5-ba51319d4ebd
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29a7f6b6-b113-4708-b8d8-04fae0125ef0
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80f6165a-e2f8-4eda-a4b0-58307696a427
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: The customers name
        name: CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e028a9ed-67c1-4276-b6cb-70f0d782884d
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73dfc4c1-d562-4d92-a40d-98021f22f901
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: LOYALTY_SEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 535fb289-1a79-4cd7-938b-e9a993e79546
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e33cd17-c2f6-480c-b36d-fd2c27de4a07
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: NUMBER(11,0)
        description: ""
        name: TAX_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79364cad-1890-4aef-a51b-8688b1545956
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a37e4802-6d3e-46e8-a589-306c5daf1af0
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: TAX_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e1bae4f-69fe-4caa-82fe-17ec619eb955
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dde23b16-f766-4c50-ace1-5d1e8ed12f23
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 514d4824-fe67-44ac-98c2-c4fd76f28be8
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 728ab715-d7c7-4bd6-ab88-78e9aa70c744
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 423921e1-ac6d-4dd6-b1f5-00ad601c169c
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d51a095-4d5c-4ce4-80c3-ee8d0a0f15c9
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: STREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39f0bfce-aa11-4091-b36d-7db7aded8dce
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb933a06-c79e-4adb-aec6-edb77d773410
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4df48a28-39f1-4d44-a90f-e75e0cbb58b2
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee445537-03ba-40e2-9fc2-44ff4f8448d3
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e37d387f-d7ff-4482-8dc9-1817933a4a2b
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0aafa38d-96b6-4829-b476-df54c49a1db9
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b78b5678-267e-4ec9-a63f-423964f3adeb
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b01e623c-e065-4dbb-83fb-34835847e808
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c47b84a-c09a-40af-bf45-db7e5c940c58
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4687e297-06f5-400c-a317-0a9b7adba671
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: POSTCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67bd68c3-0ed1-40f4-b648-c40db4785bb9
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f1444bf-62e0-4a23-a7f7-4ac5734639b6
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: LAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 706cabe8-cc9f-4714-90fd-fc0f8604559b
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd6c22f2-ecaa-417b-8bf8-438de0c1f4c8
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: LON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8048f99b-8886-42c8-b46c-6d6497f12ce5
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a87ae0b-213c-40ca-8be1-2392f5c0997f
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: SHIP_TO_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af184afc-51a6-4e0d-a6cc-51db95162b83
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 733812d2-9be0-4792-8e60-a133769f6f6b
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: NUMBER(5,1)
        description: ""
        name: UNITS_PURCHASED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf21f60-75f1-4473-ae31-cfa6adda532e
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4070e3b-430b-41ea-8cf6-9207042eeda9
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: STRING
        description: ""
        name: CUSTOMER_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf21f60-75f1-4473-ae31-cfa6adda532e
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: |-
              CASE WHEN "DS_CUSTOMERS"."UNITS_PURCHASED" > 30 THEN 'HIGH VALUE'
              ELSE 'LOW VALUE'
              END || "DS_CUSTOMERS"."REGION"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a7cb126-a765-4f3b-8bda-33c8b8d4c6e1
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: VALID_FROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571b6bc5-4dc5-49dc-a278-4d7783aa366a
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03c86ff1-54c6-4357-89ec-9705a397b202
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: NUMBER(12,1)
        description: ""
        name: VALID_TO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd6fa938-d865-483d-b85f-eb71b8db121b
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7622752-82ad-4da7-85f1-d5f31b5fe049
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: BOOLEAN
        description: ""
        name: _FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22627366-b7b2-4b43-ae60-4ddd9244531f
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5fca5af-8cda-4004-aa18-93b9742aa926
          stepCounter: 6f82eb9d-8acc-48be-a450-9fd98134cabc
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ae82211-6bdf-4b8c-bfa8-4fcf9af4052d
                stepCounter: e7e269b4-c915-404e-b101-e58b7c5e049a
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_CUSTOMERS: e7e269b4-c915-404e-b101-e58b7c5e049a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: DS_CUSTOMERS
        join:
          joinCondition: |-
            FROM {{ ref('DWH', 'DS_CUSTOMERS') }} "DS_CUSTOMERS"
            WHERE "SYSTEM_CURRENT_FLAG" = 'Y'
        name: STG_CUSTOMERS1
        noLinkRefs: []
  name: STG_CUSTOMERS1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
