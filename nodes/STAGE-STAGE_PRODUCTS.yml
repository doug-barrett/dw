fileVersion: 1
id: f976db42-7096-4b31-af40-ebd22b1f81e8
name: STAGE_PRODUCTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Denormalizes related product tables using a LEFT join from Products"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71a9ec9c-f320-4978-bd3a-7bee90005018
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40d3eb9a-d605-46f1-9c0f-f0042aeba0c7
                stepCounter: e7103a95-2a32-40cc-87d6-bc43e240fb32
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8aac24a-600d-4b2c-a7ed-f3f222c108e6
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c77d9526-7a63-47a1-8d0a-ed16d5319216
                stepCounter: e7103a95-2a32-40cc-87d6-bc43e240fb32
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7aafe92-50ba-4210-83be-f8f650fdeecf
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab62d1c2-c276-4253-870c-ce5fb8249756
                stepCounter: e7103a95-2a32-40cc-87d6-bc43e240fb32
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d018ddca-6a86-4edd-81d6-1ab271e624a7
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f7f59f7-bb67-4d30-a6c3-058dd1c64710
                stepCounter: f9a71337-7e50-4702-a336-278a8ce507f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9456fab9-4e52-4c69-8c31-062c92bd7c60
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e869a23d-2e42-4d1a-83a5-03e5596222be
                stepCounter: f9a71337-7e50-4702-a336-278a8ce507f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecbb2fb6-8677-4b4c-a46b-f240124b0c78
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33b35403-aa03-45c2-9184-16aabbaa283b
                stepCounter: e7103a95-2a32-40cc-87d6-bc43e240fb32
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4e605bb-a48c-4e2c-90f6-a49a637fa934
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe728517-501d-4db1-95ba-59558f7fb4f1
                stepCounter: 7a7a4433-663d-449e-bc80-f3f4ebddc48a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77fe1eeb-22af-46c0-981d-806290ff14c9
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3476d425-978b-4336-bed8-7c5db4495ab9
                stepCounter: e7103a95-2a32-40cc-87d6-bc43e240fb32
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38a4f10c-9d6e-4800-8f6b-9eb6cdd3ef56
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcd67647-fcc6-4fee-8688-9cd9d102c2a6
                stepCounter: e7103a95-2a32-40cc-87d6-bc43e240fb32
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6af9cfee-7400-45d9-971b-83e9bef3646c
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07b2567a-e5f7-49ae-9386-1148d5957400
                stepCounter: b76135d3-d242-4363-a7a5-c632752cb520
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 067758eb-c8cb-4b36-99d3-d57ed5b9de11
          stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PRODUCTS: e7103a95-2a32-40cc-87d6-bc43e240fb32
          DS_PRODUCT_SUPPLIERS: f9a71337-7e50-4702-a336-278a8ce507f0
          DS_PRODUCT_CATEGORIES: 7a7a4433-663d-449e-bc80-f3f4ebddc48a
          DS_PRODUCT_SALES: b76135d3-d242-4363-a7a5-c632752cb520
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: DS_PRODUCTS
          - locationName: STAGE
            nodeName: DS_PRODUCT_CATEGORIES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SALES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SUPPLIERS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','DS_PRODUCTS') }}
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SUPPLIERS') }}
                ON ds_products.supplierid = ds_product_suppliers.supplierid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_CATEGORIES') }}
                ON ds_products.categoryid = ds_product_categories.categoryid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SALES') }}
                ON ds_products.productname = ds_product_sales.productname
        name: STAGE_PRODUCTS
        noLinkRefs: []
  name: STAGE_PRODUCTS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
