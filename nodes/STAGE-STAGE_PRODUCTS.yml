fileVersion: 1
id: 27e5a621-d4cb-4009-8173-5324e5c06344
name: STAGE_PRODUCTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Denormalizes related product tables using a LEFT join from Products"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eae58c6-cfac-43fa-8eef-886645280800
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a048cdf8-2952-4b04-89fa-8187b27c4749
                stepCounter: 2ba7966f-4830-43fb-8a89-1c29def14d42
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09dcfe25-2720-45ec-9f1c-d60a3013b552
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30d2e8fa-4d02-495a-bf1d-b0a45609734d
                stepCounter: 2ba7966f-4830-43fb-8a89-1c29def14d42
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63b45259-fd16-4dfa-9ae6-ffc4f9a3fa51
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b7893ee-1912-4da0-bdcc-ef45982b6c8e
                stepCounter: 2ba7966f-4830-43fb-8a89-1c29def14d42
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 063c2d45-ad9f-4b86-9d46-917794ad0d27
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d46fbbea-5b16-4cc3-a709-dfaee44597cc
                stepCounter: cceb863a-7274-43d9-afb1-d4c89c161281
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec2f8cc6-27ad-4d50-85c6-01bb727aea86
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a91510a-cd8f-4f4c-b5b3-d9554a832b6e
                stepCounter: cceb863a-7274-43d9-afb1-d4c89c161281
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 446d4014-4d99-455e-a058-21d13fd4e82f
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e0c82ab-d71a-409d-bc0c-91e6afe8ee15
                stepCounter: 2ba7966f-4830-43fb-8a89-1c29def14d42
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ff87eed-94d8-4882-aca5-777d2b7273f5
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06ee963b-2662-49e0-ac9f-e703adaccf5c
                stepCounter: 0ead4709-ca63-4a41-810b-9f626e9c3029
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bed9cad6-463a-474c-b5e6-2f5ac131c1f3
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 542d72db-341e-4090-9a38-f2a2ffb4d50b
                stepCounter: 2ba7966f-4830-43fb-8a89-1c29def14d42
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 643baa91-4fa7-4508-9aff-b534315e109e
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88b82c04-f178-49ec-b427-8c9d63d0bd39
                stepCounter: 2ba7966f-4830-43fb-8a89-1c29def14d42
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bdeb5ba-823a-456d-8def-c9fc2abf213d
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d8c6333-c9c7-42ba-b63b-ba4b67251a67
                stepCounter: c54a1700-f95e-4d95-8d30-1024d929547d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaa3089f-6441-4c11-a922-0b06815f27fb
          stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PRODUCTS: 2ba7966f-4830-43fb-8a89-1c29def14d42
          DS_PRODUCT_SUPPLIERS: cceb863a-7274-43d9-afb1-d4c89c161281
          DS_PRODUCT_CATEGORIES: 0ead4709-ca63-4a41-810b-9f626e9c3029
          DS_PRODUCT_SALES: c54a1700-f95e-4d95-8d30-1024d929547d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: DS_PRODUCTS
          - locationName: STAGE
            nodeName: DS_PRODUCT_CATEGORIES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SALES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SUPPLIERS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','DS_PRODUCTS') }}
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SUPPLIERS') }}
                ON ds_products.supplierid = ds_product_suppliers.supplierid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_CATEGORIES') }}
                ON ds_products.categoryid = ds_product_categories.categoryid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SALES') }}
                ON ds_products.productname = ds_product_sales.productname
        name: STAGE_PRODUCTS
        noLinkRefs: []
  name: STAGE_PRODUCTS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
