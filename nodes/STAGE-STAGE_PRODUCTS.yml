fileVersion: 1
id: 6da4f18e-3f82-4cd2-81c0-68506198680e
name: STAGE_PRODUCTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Denormalizes related product tables using a LEFT join from Products"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 527e00f7-ccaf-4314-8b82-0753cfd3be8a
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4744899-d5ad-42e9-ac8d-e298857fa904
                stepCounter: 97199957-d0a3-4ddb-93b3-ed7d837a435f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df8c4314-b301-46bd-b90f-f83b81879b1a
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30010bfe-e880-43e4-ae7f-2ca3be876e8d
                stepCounter: 97199957-d0a3-4ddb-93b3-ed7d837a435f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e494d6aa-ed59-4124-8fbf-5e4953ceb94b
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f18275f-b669-413c-b294-401d01c26de3
                stepCounter: 97199957-d0a3-4ddb-93b3-ed7d837a435f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08ed1c85-1577-4e7c-b7c8-ea093ec2551e
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf577196-591f-436c-95ee-93581b04a647
                stepCounter: d7cb487f-8f7e-4727-ae7c-75e8f9134540
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50144171-51ae-44c4-8ee0-96a579e0a1e9
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04c574a6-ecd3-4896-8342-df435636ff09
                stepCounter: d7cb487f-8f7e-4727-ae7c-75e8f9134540
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38613caf-b9f2-4ddd-b70e-6211e38b54ba
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 360cff13-331e-4107-8650-87b6c4f40dae
                stepCounter: 97199957-d0a3-4ddb-93b3-ed7d837a435f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da4b755f-c76e-4d45-b514-70f10797a0ae
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5500fd37-7889-4154-9b7c-e98078da74ad
                stepCounter: d984146c-daf9-4897-bc1e-f61ec98f1361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17247d9c-3da4-4c2a-9d66-7b21c1756f85
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b8225ee-01b4-4266-b1e5-11493e287d83
                stepCounter: 97199957-d0a3-4ddb-93b3-ed7d837a435f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 868b7765-6651-406c-9e78-fd9df8b0e83c
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9dc0e0a-daee-49ad-83a1-c100d638eca6
                stepCounter: 97199957-d0a3-4ddb-93b3-ed7d837a435f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77be2d4c-e624-46b3-9543-43fcab412138
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b8a07d6-93ec-402e-8fec-b3077e5f4b12
                stepCounter: 56006b81-15dd-4280-9f78-4c4297fca175
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28e890bc-eb92-49ea-9002-55884fdba6f3
          stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PRODUCTS: 97199957-d0a3-4ddb-93b3-ed7d837a435f
          DS_PRODUCT_SUPPLIERS: d7cb487f-8f7e-4727-ae7c-75e8f9134540
          DS_PRODUCT_CATEGORIES: d984146c-daf9-4897-bc1e-f61ec98f1361
          DS_PRODUCT_SALES: 56006b81-15dd-4280-9f78-4c4297fca175
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: DS_PRODUCTS
          - locationName: STAGE
            nodeName: DS_PRODUCT_CATEGORIES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SALES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SUPPLIERS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','DS_PRODUCTS') }}
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SUPPLIERS') }}
                ON ds_products.supplierid = ds_product_suppliers.supplierid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_CATEGORIES') }}
                ON ds_products.categoryid = ds_product_categories.categoryid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SALES') }}
                ON ds_products.productname = ds_product_sales.productname
        name: STAGE_PRODUCTS
        noLinkRefs: []
  name: STAGE_PRODUCTS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
