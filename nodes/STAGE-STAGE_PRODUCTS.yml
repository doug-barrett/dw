fileVersion: 1
id: 4d6caf28-f4f4-41a5-aa01-63c967022bca
name: STAGE_PRODUCTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Denormalizes related product tables using a LEFT join from Products"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afa0f8a3-da2d-44e7-9a6e-a3a957ccba10
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d18bac5-e7cc-44c5-9071-fbe582cae2da
                stepCounter: fc613ce6-e9e1-4c45-9e2c-7be30caa50c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b108e55-7946-498b-96ae-09684b34bf22
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d46ac7e-a097-4a2f-8eb8-0d7b99a90ed5
                stepCounter: fc613ce6-e9e1-4c45-9e2c-7be30caa50c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de63e872-8dfd-4221-a567-25f49e51cbf5
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e868ec34-09dd-4711-8ba9-8c84152fad31
                stepCounter: fc613ce6-e9e1-4c45-9e2c-7be30caa50c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f774b756-8d39-4469-8992-1acdfaa2c676
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d19e8cc-08cb-48ee-8671-9d86e7a66bb1
                stepCounter: 0587135a-50ae-4294-838a-69f5e2cf74c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe88aea6-e690-48aa-89da-c236b178e187
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffcc0d34-09d4-4b38-9c55-faeaf3807465
                stepCounter: 0587135a-50ae-4294-838a-69f5e2cf74c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6b2e3c6-8015-4f6c-b1b1-db6cdae515b5
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09d23c07-2d0c-4dac-982c-74a250a6fcb0
                stepCounter: fc613ce6-e9e1-4c45-9e2c-7be30caa50c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e00eafd-8ac6-4f3a-b758-001a995093c4
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fb10533-6753-4084-bcee-f55eef114b22
                stepCounter: 301df6a6-42a8-4542-9752-7f3625b51ff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bda6a46-a712-4e2f-8509-a65af80cdde9
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e56feef5-8b9f-45b4-bea9-137261688de9
                stepCounter: fc613ce6-e9e1-4c45-9e2c-7be30caa50c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3764a52f-0f72-4576-96e1-76ed2eb161b9
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ed6ba2f-db4b-4ed5-8fd5-228ec8f48b45
                stepCounter: fc613ce6-e9e1-4c45-9e2c-7be30caa50c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c5ae764-3d2c-4d7d-b5fa-c5bbf0576cc6
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb22ee72-381e-4374-9cb4-06703e1a148c
                stepCounter: 90950765-e977-43ff-a150-9ae9ca08b8bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56530e1e-5a08-4f26-8730-cd198dec3bb7
          stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PRODUCTS: fc613ce6-e9e1-4c45-9e2c-7be30caa50c0
          DS_PRODUCT_SUPPLIERS: 0587135a-50ae-4294-838a-69f5e2cf74c9
          DS_PRODUCT_CATEGORIES: 301df6a6-42a8-4542-9752-7f3625b51ff8
          DS_PRODUCT_SALES: 90950765-e977-43ff-a150-9ae9ca08b8bd
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: DS_PRODUCTS
          - locationName: STAGE
            nodeName: DS_PRODUCT_CATEGORIES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SALES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SUPPLIERS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','DS_PRODUCTS') }}
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SUPPLIERS') }}
                ON ds_products.supplierid = ds_product_suppliers.supplierid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_CATEGORIES') }}
                ON ds_products.categoryid = ds_product_categories.categoryid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SALES') }}
                ON ds_products.productname = ds_product_sales.productname
        name: STAGE_PRODUCTS
        noLinkRefs: []
  name: STAGE_PRODUCTS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
