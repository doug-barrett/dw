fileVersion: 1
id: cefa6699-56c1-4cda-9431-a3120aa4aa62
name: STAGE_PRODUCTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Denormalizes related product tables using a LEFT join from Products"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c244d64-2ef0-4b28-89e7-7b3d3dc287cd
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ca96038-55cb-4f96-9062-63ffef963af3
                stepCounter: 41189bb7-5272-4c57-81e1-297df76557a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 534a7698-dbda-4f2d-ac5e-585e32d44cbd
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6932c12d-9db6-455d-9044-bb312532daf6
                stepCounter: 41189bb7-5272-4c57-81e1-297df76557a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1103907e-9418-413a-ae79-3ec4f9acd50d
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cbc7c91-7589-40fd-a56c-24b156f0d303
                stepCounter: 41189bb7-5272-4c57-81e1-297df76557a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 495a480f-1c27-4203-91c3-2fd557a05149
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 208e976a-228c-42cc-89ad-366d39fe7278
                stepCounter: fbe0871d-f788-4aa6-b5c3-d273bc4198d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 747bf8cd-08be-43f4-83f6-6a77a135ad6e
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 890ece1e-b8d0-4529-aa3c-6815b9fb11ba
                stepCounter: fbe0871d-f788-4aa6-b5c3-d273bc4198d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a124c89-b7bf-4e53-b5d7-6f367b0fc19a
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62e64772-d36c-4a62-bc70-39150ca259e5
                stepCounter: 41189bb7-5272-4c57-81e1-297df76557a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f4918c4-aebd-4f33-a01e-1033dd4dba7c
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0b8bedd-a6c5-4b49-a9a5-f3d941ccf551
                stepCounter: be6747fe-5097-40c8-9270-019a9843c2b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cab4712-b110-4ffe-afe2-6a3e10b92d31
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5827198-a22c-4237-83d6-741187184f11
                stepCounter: 41189bb7-5272-4c57-81e1-297df76557a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b7d261c-9016-4528-bc0d-f6432c7bc9c1
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d176b31-e377-4fa1-b130-079c763d3412
                stepCounter: 41189bb7-5272-4c57-81e1-297df76557a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5d862b5-f2e4-4c10-bfa2-8a249f8477ab
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1093723e-ad97-42bf-9f26-b42a29f9523a
                stepCounter: e8114414-a06f-4b02-92cb-e7f9d763a465
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 609a50b2-8203-41cc-87e7-89ae2f0e4faf
          stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PRODUCTS: 41189bb7-5272-4c57-81e1-297df76557a4
          DS_PRODUCT_SUPPLIERS: fbe0871d-f788-4aa6-b5c3-d273bc4198d0
          DS_PRODUCT_CATEGORIES: be6747fe-5097-40c8-9270-019a9843c2b4
          DS_PRODUCT_SALES: e8114414-a06f-4b02-92cb-e7f9d763a465
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: DS_PRODUCTS
          - locationName: STAGE
            nodeName: DS_PRODUCT_CATEGORIES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SALES
          - locationName: STAGE
            nodeName: DS_PRODUCT_SUPPLIERS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','DS_PRODUCTS') }}
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SUPPLIERS') }}
                ON ds_products.supplierid = ds_product_suppliers.supplierid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_CATEGORIES') }}
                ON ds_products.categoryid = ds_product_categories.categoryid
              LEFT OUTER JOIN {{ ref('STAGE','DS_PRODUCT_SALES') }}
                ON ds_products.productname = ds_product_sales.productname
        name: STAGE_PRODUCTS
        noLinkRefs: []
  name: STAGE_PRODUCTS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
