steps:
  SATV1_ORDERS-4d8c0cc8-6007-48d6-b54a-9b0811744775:
    operation:
      config:
        postSQL: ""
        preSQL: ""
      database: ""
      deployEnabled: true
      description: Orders data as defined by TPC-H
      isMultisource: false
      locationName: DWH
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: a0887c21-07b8-492f-92cc-6530f2ce66d3
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            config:
              is_hk: true
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: H_ORDER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c6384120-00ec-4537-abec-b7e879ed63b9
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: 237af4e1-71a1-42aa-b6f8-f6707c5f0d33
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 15967a1a-2876-4d40-abaa-d33519d5fd3f
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: f090cb8d-950b-4b92-963b-a8ea0833e9ae
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 39cbd6d3-1c03-4aae-8fdc-de2b55873bc6
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: 93ca38b1-6437-431d-b036-9cc442360c09
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4ef921dc-147e-4d1d-957c-2749d205123b
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: 79200502-b262-44bb-a20e-5431d2529bca
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2fb4ff20-a816-4716-a10c-54f1313d105b
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: 0b2f5db5-698d-40be-8017-cc2f7b7fd7d6
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 49400675-ba42-4bce-b1ce-abdb4bb9d911
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: 50dc0e16-d086-431d-ab58-04d1bd67aeaf
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 53dfafc3-3c4a-4e5b-951d-f801071797fb
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: a03db113-999b-40e4-8e0f-67871e1d3516
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8a57993a-3c10-4ea2-9ef4-1e80c840dbce
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: 0b5df1de-558b-4938-8f0a-5c06a7c75182
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8bd542de-10f5-4a1c-b520-20b7d90bf5e7
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: ed9fc252-54c3-41b0-baed-424d2674a850
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7aac0788-d129-4c36-8b01-5c250d3f6dd1
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: 4e1e7dd8-c3ad-46ad-9d71-b810b42ea444
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: TIMESTAMP
            description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
            hashColumns: []
            hashDetails: null
            name: LDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2d272837-a1c2-474a-bbcb-d0ead72813e1
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: 8e83b609-a46c-4ce6-8c8e-9cf41e0ee23e
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: STRING
            description: The Record Source (RSRC) describes the source of this data.
            hashColumns: []
            hashDetails: null
            name: RSRC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9e71728c-5b87-4614-8089-6a6b96bfc03b
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - columnReference:
              columnCounter: da9c1e61-f1c1-4247-8599-79921fe74fe6
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: S_ORDERS_HASH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5f3f954d-2d97-4d74-918a-d0ddcfe6ff94
                    stepCounter: a76512ee-8b44-4aec-be75-b89316f18640
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: d88ccfe5-9456-4356-93e1-9b3be8eaf4b4
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_ledts: true
            name: LEDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 0581259b-8fd1-450a-b6d7-afb378f86fde
              stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
            config: {}
            dataType: BOOLEAN
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_current_col: true
            name: IS_CURRENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  CASE 
                    WHEN 
                      LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                      OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                      ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                    THEN TRUE 
                    ELSE FALSE 
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: DWH
                nodeName: SATV0_ORDERS
            join:
              joinCondition: FROM {{ ref('DWH', 'SATV0_ORDERS') }} "SATV0_ORDERS"
            name: SATV1_ORDERS
            noLinkRefs: []
      name: SATV1_ORDERS
      overrideSQL: false
      schema: ""
      sqlType: "9"
      type: sql
    stepCounter: 4d8c0cc8-6007-48d6-b54a-9b0811744775
