fileVersion: 1
id: 78ea87c4-81d4-4b2a-974a-89b352839c24
name: STG_SUPPLIER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Supplier data as defined by TPC-H
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f14c74a1-f3d7-48e0-8d8e-499d657106ab
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14263550-b8e7-4006-97f2-ba64a084146d
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c908bac-31e5-4a4c-82bd-6dae6ec2b78c
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SUPPLIER_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0017d46-786b-4e70-8a01-f24b81a694ff
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 439f0ab7-0631-40a3-914d-ecede4b7ff69
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: SUPPLIER_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22f8f676-db4e-4ac6-8007-93a79fe77d81
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f583ed0d-6d97-46c4-b37e-3ae3b82b74f8
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SUPPLIER_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b21c4f7-f2aa-4cf7-a1e0-0cb8723d3e96
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73a58b6b-de17-44f9-a919-88d1ef4e907a
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SUPPLIER_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0e989dd-60de-4250-95e7-54f201f54ec5
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eb5f2d1-ae7e-46db-88de-70e5ceabc553
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: SUPPLIER_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88d4826c-5950-4c89-8008-b2dcbbc4c9d5
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfa89cb8-7f48-4349-9515-f5fcee491907
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: SUPPLIER_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e2ab289-e56e-4f07-acaa-cef2de59661f
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3c91997-3493-4357-9cb8-92a1fa8128f5
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: STRING
        description: ""
        name: SUPPLIER_ACCTBAL_CAT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e2ab289-e56e-4f07-acaa-cef2de59661f
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: |-
              CASE WHEN "SATV1_SUPPLIER"."S_ACCTBAL" > 5000 THEN 'HIGH'
              ELSE 'LOW'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fa386b2-7a83-4197-b070-13809e04bb3a
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: SUPPLIER_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78a6ff8a-52b1-405d-82bd-52f2853ecd9d
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de33e73f-36cd-4469-99c9-f44255ea7659
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: STRING
        description: ""
        name: SUPPLIER_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebce7132-104e-479a-9375-53abf21796a3
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffe4a952-5e07-411d-9f23-ba5f6adbfda9
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f339b6b0-e248-4331-86b1-cd1be8916e6a
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ce0bae0-72d3-4820-9f5f-fc7ead4b0fbc
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7171c1b7-2b47-4937-863e-d425344ebd4c
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daa0e4a6-bf41-4f5d-8fe6-64c674ac91ef
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7bfe0e0-68e9-4ef3-84ba-649ce2b13485
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77308ed6-991a-48e8-915c-581d670a81b2
          stepCounter: 78ea87c4-81d4-4b2a-974a-89b352839c24
        config: {}
        dataType: BOOLEAN
        description: ""
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d10edce-091c-40d6-963d-63d9a8930a19
                stepCounter: 106cb041-8bf6-4781-af50-771b40089311
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          SATV1_SUPPLIER: 106cb041-8bf6-4781-af50-771b40089311
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV1_SUPPLIER
        join:
          joinCondition: |-
            FROM {{ ref('DWH', 'SATV1_SUPPLIER') }} "SATV1_SUPPLIER"

            WHERE "SATV1_SUPPLIER"."IS_CURRENT"
        name: STG_SUPPLIER
        noLinkRefs: []
  name: STG_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
