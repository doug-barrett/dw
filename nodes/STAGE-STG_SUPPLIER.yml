fileVersion: 1
id: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
name: STG_SUPPLIER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests:
      - continueOnFailure: true
        description: ""
        name: Test
        runOrder: After
        templateString: |-
          SELECT 1
          FROM {{this}}
          WHERE S_NAME LIKE 'TEST%'
    columns:
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 43f21794-9310-49a6-a69a-4cec80e0db44
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f6485ee-abab-45f5-a0e6-9c68a9ccd2ec
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: ""
      - appliedColumnTests:
          hasNull: true
          isDistinct: false
        columnReference:
          columnCounter: adc7def5-4099-4714-9914-b37d3949380b
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 244e5632-f3e8-4d91-a5da-5623ad7f9aca
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: ""
      - appliedColumnTests:
          hasNull: true
          isDistinct: false
        columnReference:
          columnCounter: 6fa9087b-46e3-4fab-8dfb-413c8f5f3cb9
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c4b09a8-abf2-4dcb-a2fa-aed6202abede
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: UPPER("SATV1_SUPPLIER"."S_NAME")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 461b71a7-423a-42a6-b630-25ee45bcec42
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c046a389-faa6-44f4-a81a-de337c61db33
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: UPPER("SATV1_SUPPLIER"."S_ADDRESS")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: c07847fa-b78d-496f-83cf-0e7b820f0607
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80bdc9de-f1dc-4d37-96ff-3e89b350bb48
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 9fd6828c-a9ce-433b-8c99-80bb816d5762
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 208241c3-9c37-4eaa-b450-10963f9c5c66
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: UPPER("SATV1_SUPPLIER"."S_PHONE")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: cd51790d-4132-4f7c-94a1-0c77c5e3210f
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f0c086b-811c-4c12-bd94-3b09f19d8d43
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 7ae6a705-386f-4616-8257-f20a832f5481
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a22da9a-aa49-4614-a1ad-9965198bb93f
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: UPPER("SATV1_SUPPLIER"."S_COMMENT")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: abcd5b4e-523a-4552-9b0d-7c17c3258e5f
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: BOOLEAN
        description: ""
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9562a12-cb3b-4a16-918b-81559f04d028
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 31dbaf84-face-409e-bb9e-7113ca94386f
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74a9db50-e462-46f4-bf25-516d6c9203ba
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 9bcfb096-46a6-4201-ad49-3a135881c9d6
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acaeb205-45b0-411e-a48f-86d8945cc3e1
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: ff6aa675-edca-4802-9340-8cdc4eecf905
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e8066ad-7876-4a64-aaf2-47676b4d65fb
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: d6811724-2bd9-41ba-a4f7-c636ee354942
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: STRING
        description: ""
        name: S_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f7567bb-a4da-44b7-8ba3-0334e421f9aa
                stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 35847256-b281-431f-a5d6-dc6a4a0e6210
          stepCounter: ad72ed0c-4cb6-4553-8132-64ab81f6b9c5
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CUST_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE WHEN "SATV1_SUPPLIER"."S_ACCTBAL" > 5000 THEN "SATV1_SUPPLIER"."S_NAME" ELSE 'LOW VALUE' END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs:
      - hasNull
      - isDistinct
    sourceMapping:
      - aliases:
          SATV1_SUPPLIER: 4cd295f1-cc14-46ac-914b-28098d1acc24
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV1_SUPPLIER
        join:
          joinCondition: |-
            FROM {{ ref('DWH', 'SATV1_SUPPLIER') }} "SATV1_SUPPLIER"
            WHERE "IS_CURRENT" 
        name: STG_SUPPLIER
        noLinkRefs: []
  name: STG_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
