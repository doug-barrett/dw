fileVersion: 1
id: fc728339-7f5b-40c3-98d4-4fbf5328103a
name: AGG_ORDERS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DW
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e3d535f-2d72-440c-b0b7-29f892d1cb22
          stepCounter: fc728339-7f5b-40c3-98d4-4fbf5328103a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: ORDER_CAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 111e77e9-9091-45ed-b590-365b2dea3971
                stepCounter: 6561ed17-1dac-4e82-b7df-03a686264ed8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3510e804-8a0e-4137-bd3c-8a8fe43da9a2
          stepCounter: fc728339-7f5b-40c3-98d4-4fbf5328103a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: This is the customers head office address country
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b98de59d-80de-4940-903e-47d9fc768ce0
                stepCounter: c91cd052-1564-4a56-82ae-3de683e600be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac9c7402-0263-42cd-9f3f-69a8f1ed5a7b
          stepCounter: fc728339-7f5b-40c3-98d4-4fbf5328103a
        config: {}
        dataType: INT
        defaultValue: ""
        description: This is the internal order id
        isBusinessKey: true
        name: ORDER_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf536672-b8bb-4d7a-bc3f-af11bc8f4aa8
                stepCounter: f41100ad-2f09-4b59-9d66-84a1979e32ed
            transform: count(1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bafdaa75-b8b9-44ea-9fdf-b548b01db1be
          stepCounter: fc728339-7f5b-40c3-98d4-4fbf5328103a
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: The order freight costs
        name: FREIGHT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 087d17d5-0f32-4bc2-bac6-dd99775caed4
                stepCounter: f41100ad-2f09-4b59-9d66-84a1979e32ed
            transform: sum(fact_orders.freight)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07995f7c-5d3d-4175-b1fa-cce9c90bf5de
          stepCounter: fc728339-7f5b-40c3-98d4-4fbf5328103a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bb900f4-646f-4aa2-8365-c94e8604816d
          stepCounter: fc728339-7f5b-40c3-98d4-4fbf5328103a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_ORDER_DATE: 6561ed17-1dac-4e82-b7df-03a686264ed8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DW
            nodeName: DIM_CUSTOMERS
          - locationName: DW
            nodeName: DIM_ORDER_DATE
          - locationName: DW
            nodeName: FACT_ORDERS
        join:
          joinCondition: FROM {{ ref('DW','DIM_ORDER_DATE') }}
        name: AGG_ORDERS
        noLinkRefs: []
  name: AGG_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
