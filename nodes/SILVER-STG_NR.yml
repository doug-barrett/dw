fileVersion: 1
id: cb95eb04-f662-41ec-9ce2-7c058ea45059
name: STG_NR
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Normal records with row numbering
  isMultisource: false
  locationName: SILVER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8daaeb3e-9cf8-4763-a510-576caf96f498
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: DATE
        description: ""
        name: DAY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8daaeb3e-9cf8-4763-a510-576caf96f498
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"DAY_DATE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60036897-004d-402b-a37e-84889562f1e7
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: SALES_TEAM_REPORTING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60036897-004d-402b-a37e-84889562f1e7
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"SALES_TEAM_REPORTING\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af23411d-8bb6-4ada-bca4-c685c8de20ab
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af23411d-8bb6-4ada-bca4-c685c8de20ab
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"ID\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49586665-ac4e-4014-a54a-da690d003ffd
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49586665-ac4e-4014-a54a-da690d003ffd
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"ACCOUNT_ID\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b53e961d-9989-4a9a-bc21-ec83a71a2d2c
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b53e961d-9989-4a9a-bc21-ec83a71a2d2c
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"CREATED_DATE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a740a0d0-3b95-48e0-8837-96b987ea7c39
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: DATE
        description: ""
        name: CLOSE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a740a0d0-3b95-48e0-8837-96b987ea7c39
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"CLOSE_DATE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9182029-d2bb-463c-b1ba-43853de4b235
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9182029-d2bb-463c-b1ba-43853de4b235
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"NAME\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92091d70-0e96-46c0-bef2-db95bf9a3523
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: NUMBER
        description: ""
        name: NET_NEW_ACV
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92091d70-0e96-46c0-bef2-db95bf9a3523
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"NET_NEW_ACV\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e03aec0-e6ec-49a1-8411-68a86edb6268
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: STAGE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e03aec0-e6ec-49a1-8411-68a86edb6268
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"STAGE_NAME\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bc09233-a962-4aef-ba33-528f5910e0e3
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: OWNER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bc09233-a962-4aef-ba33-528f5910e0e3
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"OWNER_ID\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5dc6fda-922b-43ab-a8fe-f43299d46b47
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: SALES_TEAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5dc6fda-922b-43ab-a8fe-f43299d46b47
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"SALES_TEAM\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f3e1d2c-2e02-43f6-862b-b810d0263ee5
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: PRM_PARTNER_LEVEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f3e1d2c-2e02-43f6-862b-b810d0263ee5
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"PRM_PARTNER_LEVEL\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dee56494-25ef-4b87-aa2c-2d1191d1e8b4
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: DBT_VALID_FROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dee56494-25ef-4b87-aa2c-2d1191d1e8b4
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"DBT_VALID_FROM\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 223567af-b885-48dc-a375-940eafb4ce8b
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: DBT_VALID_TO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223567af-b885-48dc-a375-940eafb4ce8b
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"DBT_VALID_TO\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76eb2b32-42d6-4f33-add0-5ee146ecfdcc
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: MULTI_YEAR_SUBSCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76eb2b32-42d6-4f33-add0-5ee146ecfdcc
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"MULTI_YEAR_SUBSCRIPTION\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd8c1f73-a823-4afb-a6c1-4319a87aca2c
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: TERRITORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd8c1f73-a823-4afb-a6c1-4319a87aca2c
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"TERRITORY\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e194e2e-e29c-4d11-b6eb-0ff5d48c47b7
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e194e2e-e29c-4d11-b6eb-0ff5d48c47b7
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"PARTNER_TYPE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 879f04de-c241-4e5b-8e79-486780466ce1
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: OPPORTUNITY_OWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 879f04de-c241-4e5b-8e79-486780466ce1
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"OPPORTUNITY_OWNER\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 929e03f8-8251-421c-8069-c44fe4befd5a
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: SUB_TEAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 929e03f8-8251-421c-8069-c44fe4befd5a
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"SUB_TEAM\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc7ec65a-1483-41b0-a031-9072319475bb
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: USER_ROLE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc7ec65a-1483-41b0-a031-9072319475bb
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"USER_ROLE_ID\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2308416c-d0fa-429b-88ca-b3bcfc588fbc
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: VARCHAR
        description: ""
        name: OWNER_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2308416c-d0fa-429b-88ca-b3bcfc588fbc
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"OWNER_ROLE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d21a2282-78de-41f9-a3d2-dfd47c334974
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: VALID_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d21a2282-78de-41f9-a3d2-dfd47c334974
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: "\"VALID_DATE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27cb2584-afcf-4598-9b4e-b1b0d17d9cc8
          stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
        config: {}
        dataType: NUMBER
        description: ""
        name: ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27cb2584-afcf-4598-9b4e-b1b0d17d9cc8
                stepCounter: cb95eb04-f662-41ec-9ce2-7c058ea45059
            transform: ROW_NUMBER() OVER (PARTITION BY "ID","DAY_DATE" ORDER BY "DBT_VALID_FROM" DESC, "STAGE_NAME" DESC)
    cteString: ""
    description: ""
    destinationName: ""
    enabledColumnTestIDs: []
    materializationOption: ""
    sourceMapping:
      - aliases:
          STG_EXPANDED_DAYS: 77888b25-868e-4bf1-a7e3-89361ec3a98f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SILVER
            nodeName: STG_CREATED_BEFORE
          - locationName: SILVER
            nodeName: STG_EXPANDED_DAYS
        join:
          joinCondition: |-
            FROM {{ ref('SILVER', 'STG_EXPANDED_DAYS') }} "STG_EXPANDED_DAYS"
            WHERE CONCAT("ID","DAY_DATE") NOT IN (
                SELECT CONCAT("ID","DAY_DATE") 
                FROM {{ ref('SILVER', 'STG_CREATED_BEFORE') }} "STG_CREATED_BEFORE"
            )
            AND "DAY_DATE" BETWEEN DATE_TRUNC(DAY,"DBT_VALID_FROM") AND DATE_TRUNC(DAY,"VALID_DATE")
        name: STG_NR
        noLinkRefs: []
  name: STG_NR
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
