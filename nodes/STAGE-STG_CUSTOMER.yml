fileVersion: 1
id: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: This is stage customer main
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests:
          hasNull: true
          isDistinct: false
        columnReference:
          columnCounter: 63c6b52f-cf4f-4cb1-bde4-19e9f438cc18
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4d9564c-4ba0-4220-9be4-54c8ddec51af
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: f6567d7b-1d01-44b6-a650-cedb06f6da0e
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: STRING
        description: The customers name
        name: CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26881281-fd02-448a-b737-7bcc011c5d91
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: UPPER("INC_CUSTOMER"."C_NAME")
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 0faf3841-fe05-4238-93a0-1b25a64c9dbc
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: STRING
        description: ""
        name: C_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16157201-56cd-4163-a186-7f2c715a886e
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: NVL("INC_CUSTOMER"."C_ADDRESS",'')
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: b1e8159a-8b0f-491a-9c1b-d63bafacb9df
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: STRING
        description: Nation customer is based
        name: NATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12418cb8-1270-4829-b0d2-05f86236efc4
                stepCounter: 930c6a47-66a1-4323-8096-394d8ae695e0
            transform: NVL("INC_NATION"."N_NAME",'')
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 5832d5c8-a862-49bb-ba1f-34fd57a949a6
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: STRING
        description: Geographic region customer is based
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 514edef3-d61e-4271-9fa4-6a5f0b1cf176
                stepCounter: 04fbb85d-676d-4495-aaa2-e8f38f4deb55
            transform: NVL("INC_REGION"."R_NAME",'')
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 3f8debba-e4aa-46be-918e-661857f435d1
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: STRING
        description: xx
        name: C_NATIONKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 626d7b6b-dec7-498e-9a26-3a3af8efd6cf
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: NVL("INC_CUSTOMER"."C_NATIONKEY",'')
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: e343aef2-1e4c-4c5b-a9ec-c4f46583ec14
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: STRING
        description: ""
        name: C_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d313dff-0858-4148-bfe4-82ea24053b9a
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: NVL("INC_CUSTOMER"."C_PHONE",'')
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: d92bee15-ace1-4ffa-9e81-ab85a435070a
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: STRING
        description: ""
        name: C_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05d2ddf7-e328-4790-9b1f-bdaba8bc80f6
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 56a0ce33-115a-4ab1-a01a-1707225cee4e
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: STRING
        defaultValue: "'UNNKNOWN'"
        description: ""
        name: C_ACCTBAL_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05d2ddf7-e328-4790-9b1f-bdaba8bc80f6
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: |-
              CASE WHEN "INC_CUSTOMER"."C_ACCTBAL" > 5000 THEN 'HIGH'
              ELSE 'LOW'
              END
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: d6a47e74-c7be-491c-a2ee-db96ef46fe23
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f37d54a8-3f7e-4765-be50-3f4e96dddf82
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 6390dc5e-82e4-4d6f-9fb8-0aca6d915c23
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04fd94b1-e350-42ec-af0c-f16a39477081
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 34628573-df20-4fe0-879f-99e5f5255bf1
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da341c0b-f191-49c5-8dbe-8435a22d2ab7
                stepCounter: 04fbb85d-676d-4495-aaa2-e8f38f4deb55
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 1ad40b86-043e-4c35-8c7d-d1cb09291d14
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b0fb553-f816-47e8-96ec-332bb4a819e4
                stepCounter: 930c6a47-66a1-4323-8096-394d8ae695e0
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: b2708bf9-acca-4848-aed0-1a1bf2b8cd97
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: SHA1
        hashedColumns:
          - columnCounter: f6567d7b-1d01-44b6-a650-cedb06f6da0e
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: 0faf3841-fe05-4238-93a0-1b25a64c9dbc
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: b1e8159a-8b0f-491a-9c1b-d63bafacb9df
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: 5832d5c8-a862-49bb-ba1f-34fd57a949a6
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: 3f8debba-e4aa-46be-918e-661857f435d1
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: e343aef2-1e4c-4c5b-a9ec-c4f46583ec14
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: d92bee15-ace1-4ffa-9e81-ab85a435070a
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: 56a0ce33-115a-4ab1-a01a-1707225cee4e
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: d6a47e74-c7be-491c-a2ee-db96ef46fe23
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: 6390dc5e-82e4-4d6f-9fb8-0aca6d915c23
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: 34628573-df20-4fe0-879f-99e5f5255bf1
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
          - columnCounter: 1ad40b86-043e-4c35-8c7d-d1cb09291d14
            stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        name: CUSTOMER_HASH
        nullable: true
        sourceColumnReferences: []
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: bd29a384-0b5a-429d-9f47-812e22000d60
          stepCounter: 6269a7fe-18c6-4579-9dfe-f2a592e1fc99
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04fd94b1-e350-42ec-af0c-f16a39477081
                stepCounter: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
            transform: ""
    cteString: ""
    enabledColumnTestIDs:
      - hasNull
      - isDistinct
    sourceMapping:
      - aliases:
          INC_CUSTOMER: 49fa0a4e-b414-43e9-afc5-1b15d81ae8bf
          INC_NATION: 930c6a47-66a1-4323-8096-394d8ae695e0
          INC_REGION: 04fbb85d-676d-4495-aaa2-e8f38f4deb55
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: INC_CUSTOMER
          - locationName: STAGE
            nodeName: INC_NATION
          - locationName: STAGE
            nodeName: INC_REGION
        join:
          joinCondition: |-

            FROM {{ ref('STAGE', 'INC_CUSTOMER') }} "INC_CUSTOMER"
            INNER JOIN {{ ref('STAGE', 'INC_NATION') }} "INC_NATION"
            ON "INC_CUSTOMER"."C_NATIONKEY"= "INC_NATION"."N_NATIONKEY"
            INNER JOIN {{ ref('STAGE', 'INC_REGION') }} "INC_REGION"
            ON INC_NATION."N_REGIONKEY"= "INC_REGION"."R_REGIONKEY"

            where 1 = 1
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
