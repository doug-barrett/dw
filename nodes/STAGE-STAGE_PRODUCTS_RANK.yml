fileVersion: 1
id: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
name: STAGE_PRODUCTS_RANK
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Applies business transforms - specifically Ranking transforms based on sales amounts."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25aa376e-c382-429b-b91e-84c2b2e37a7f
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afa0f8a3-da2d-44e7-9a6e-a3a957ccba10
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f9a71f4-0bb5-4e97-8276-6c168b6ad1ae
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b108e55-7946-498b-96ae-09684b34bf22
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 155e86af-ca0a-47a9-8611-2b031142288e
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de63e872-8dfd-4221-a567-25f49e51cbf5
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b875ecf3-ba2d-4355-a08b-06aebc5d1914
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f774b756-8d39-4469-8992-1acdfaa2c676
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 226e27a7-bb9d-4a0e-b117-149b0754a556
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe88aea6-e690-48aa-89da-c236b178e187
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f9e519a-88c3-4c45-a254-43381dcf7641
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6b2e3c6-8015-4f6c-b1b1-db6cdae515b5
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad4676cf-ebb0-40cd-90db-851735aec8e0
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e00eafd-8ac6-4f3a-b758-001a995093c4
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3bb8e91-9b35-449a-ba92-f604a76b1623
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bda6a46-a712-4e2f-8509-a65af80cdde9
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a355e2d5-a78f-4ad5-af7f-b2b26b9fc674
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3764a52f-0f72-4576-96e1-76ed2eb161b9
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e24de352-bb18-4d96-b444-18a744070a71
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c5ae764-3d2c-4d7d-b5fa-c5bbf0576cc6
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 383a3602-3bcc-44cb-bccf-2d678824849a
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by historical sales
        name: PRODUCT_RANK_BY_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c5ae764-3d2c-4d7d-b5fa-c5bbf0576cc6
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: RANK() OVER (ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0928946-9dd2-4b1b-9a92-8723e895af23
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product in category by historical sales
        name: PRODUCT_RANK_BY_SALES_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c5ae764-3d2c-4d7d-b5fa-c5bbf0576cc6
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: RANK() OVER (PARTITION BY stage_products.categoryid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d394c1bb-8f7d-48f9-98ad-1a77e499d8cc
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by supplier by historical sales
        name: PRODUCT_RANK_BY_SALES_SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c5ae764-3d2c-4d7d-b5fa-c5bbf0576cc6
                stepCounter: 4d6caf28-f4f4-41a5-aa01-63c967022bca
            transform: RANK() OVER (PARTITION BY stage_products.supplierid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03b3b714-9f30-4680-b39c-d81ae2bc90dd
          stepCounter: 1ea88c13-0d71-43fc-890d-8dd10c8d83a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_PRODUCTS: 4d6caf28-f4f4-41a5-aa01-63c967022bca
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGE_PRODUCTS
        join:
          joinCondition: FROM {{ ref('STAGE','STAGE_PRODUCTS') }}
        name: STAGE_PRODUCTS_RANK
        noLinkRefs: []
  name: STAGE_PRODUCTS_RANK
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
