fileVersion: 1
id: 093d0dc5-f48c-4743-8b0e-942c47984bc6
name: STAGE_PRODUCTS_RANK
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Applies business transforms - specifically Ranking transforms based on sales amounts."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daf04c4b-4ed5-494b-8633-66c2142a8b49
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c244d64-2ef0-4b28-89e7-7b3d3dc287cd
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4feab4f4-f2de-436c-b06f-1538ea7a40aa
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 534a7698-dbda-4f2d-ac5e-585e32d44cbd
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b8695b9-1a0b-4b5f-952b-976524cd0b77
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1103907e-9418-413a-ae79-3ec4f9acd50d
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ceb1dd2-33ae-4a53-9524-06bfe2957292
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 495a480f-1c27-4203-91c3-2fd557a05149
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0be584d-901a-4cd3-b734-742f6b215886
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 747bf8cd-08be-43f4-83f6-6a77a135ad6e
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1308960b-30a6-4100-a566-162e3e8f8cf4
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a124c89-b7bf-4e53-b5d7-6f367b0fc19a
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afb2a7e5-0230-4bfa-907e-e03437b4e93f
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f4918c4-aebd-4f33-a01e-1033dd4dba7c
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0959c72-ba81-42d7-97d0-8ed847f23abf
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cab4712-b110-4ffe-afe2-6a3e10b92d31
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d910db38-a212-4d19-8c82-57a37598cc8a
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b7d261c-9016-4528-bc0d-f6432c7bc9c1
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf91cb7a-e030-4f76-802e-e42bd781ec8c
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5d862b5-f2e4-4c10-bfa2-8a249f8477ab
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89331b28-6b82-4d86-8d62-fbec1962c713
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by historical sales
        name: PRODUCT_RANK_BY_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5d862b5-f2e4-4c10-bfa2-8a249f8477ab
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: RANK() OVER (ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a00f0623-d8f1-484c-b369-1097699b3f9f
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product in category by historical sales
        name: PRODUCT_RANK_BY_SALES_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5d862b5-f2e4-4c10-bfa2-8a249f8477ab
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: RANK() OVER (PARTITION BY stage_products.categoryid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a32d5760-1a6f-41c4-9c90-ae0f8c4b5a93
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by supplier by historical sales
        name: PRODUCT_RANK_BY_SALES_SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5d862b5-f2e4-4c10-bfa2-8a249f8477ab
                stepCounter: cefa6699-56c1-4cda-9431-a3120aa4aa62
            transform: RANK() OVER (PARTITION BY stage_products.supplierid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 383612a1-d3ae-42b1-9c97-eb272727156e
          stepCounter: 093d0dc5-f48c-4743-8b0e-942c47984bc6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_PRODUCTS: cefa6699-56c1-4cda-9431-a3120aa4aa62
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGE_PRODUCTS
        join:
          joinCondition: FROM {{ ref('STAGE','STAGE_PRODUCTS') }}
        name: STAGE_PRODUCTS_RANK
        noLinkRefs: []
  name: STAGE_PRODUCTS_RANK
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
