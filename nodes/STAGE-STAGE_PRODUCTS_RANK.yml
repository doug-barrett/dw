fileVersion: 1
id: 8bbf044a-2919-4824-b27f-2b97756f0574
name: STAGE_PRODUCTS_RANK
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Applies business transforms - specifically Ranking transforms based on sales amounts."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3af8ddd9-1a2e-48f3-a037-6b1e1311ed17
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 527e00f7-ccaf-4314-8b82-0753cfd3be8a
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e299369b-ba65-4d98-88a1-ee7be5388d62
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df8c4314-b301-46bd-b90f-f83b81879b1a
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c4abdc7-ad3a-4d01-b7d9-eb73e32333d3
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e494d6aa-ed59-4124-8fbf-5e4953ceb94b
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d3a9431-e1aa-4245-986f-409f0541fdf5
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08ed1c85-1577-4e7c-b7c8-ea093ec2551e
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86578464-1ebc-42eb-87f5-9130b89e2a8c
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50144171-51ae-44c4-8ee0-96a579e0a1e9
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cff0f9f4-1ced-4556-ad9d-2181a2ba969e
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38613caf-b9f2-4ddd-b70e-6211e38b54ba
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 141e392e-baa2-4798-90b0-8fe5c2fea5d6
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da4b755f-c76e-4d45-b514-70f10797a0ae
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd5248d6-6ae5-4789-9d50-f92c9a02a777
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17247d9c-3da4-4c2a-9d66-7b21c1756f85
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1551920-a51e-44fe-ad3b-8747c8665e49
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 868b7765-6651-406c-9e78-fd9df8b0e83c
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67437dcf-bc5e-44fd-b6bd-3f0ca4bef23f
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be2d4c-e624-46b3-9543-43fcab412138
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87190f98-8bb6-4fbd-9888-c965d61aa0f1
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by historical sales
        name: PRODUCT_RANK_BY_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be2d4c-e624-46b3-9543-43fcab412138
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: RANK() OVER (ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63f68c4b-fd1f-4e29-979b-0dd51ec62108
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product in category by historical sales
        name: PRODUCT_RANK_BY_SALES_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be2d4c-e624-46b3-9543-43fcab412138
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: RANK() OVER (PARTITION BY stage_products.categoryid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef2ef541-3baf-45b5-929d-b9755f36714a
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by supplier by historical sales
        name: PRODUCT_RANK_BY_SALES_SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be2d4c-e624-46b3-9543-43fcab412138
                stepCounter: 6da4f18e-3f82-4cd2-81c0-68506198680e
            transform: RANK() OVER (PARTITION BY stage_products.supplierid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75a3f9d2-786e-4f9c-b791-f638fa68800e
          stepCounter: 8bbf044a-2919-4824-b27f-2b97756f0574
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_PRODUCTS: 6da4f18e-3f82-4cd2-81c0-68506198680e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGE_PRODUCTS
        join:
          joinCondition: FROM {{ ref('STAGE','STAGE_PRODUCTS') }}
        name: STAGE_PRODUCTS_RANK
        noLinkRefs: []
  name: STAGE_PRODUCTS_RANK
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
