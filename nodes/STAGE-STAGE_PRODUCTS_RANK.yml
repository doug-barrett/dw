fileVersion: 1
id: 48721eb8-6d09-4293-81fa-8143ffb946e2
name: STAGE_PRODUCTS_RANK
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Applies business transforms - specifically Ranking transforms based on sales amounts."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f83e560-4ad2-408e-bd6f-60d2c9860dc1
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71a9ec9c-f320-4978-bd3a-7bee90005018
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d29eab8-66f4-46cb-b611-734fa395f894
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8aac24a-600d-4b2c-a7ed-f3f222c108e6
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 903c7d3d-4a4d-4edf-9f17-fc9ca122da2d
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7aafe92-50ba-4210-83be-f8f650fdeecf
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cce86b37-021b-40a8-9330-277fb7384e67
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d018ddca-6a86-4edd-81d6-1ab271e624a7
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ba72006-ecff-47c3-980c-f310d5ac7019
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9456fab9-4e52-4c69-8c31-062c92bd7c60
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45b20765-d25c-491d-97ea-386f15851c08
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecbb2fb6-8677-4b4c-a46b-f240124b0c78
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88df971a-2b79-4373-b7be-345c8b2e46c3
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4e605bb-a48c-4e2c-90f6-a49a637fa934
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ea8d4fb-1e3d-4eec-8802-be3792b247d6
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77fe1eeb-22af-46c0-981d-806290ff14c9
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f06c90f-5070-4ed7-9f04-d0be5f59c3f7
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38a4f10c-9d6e-4800-8f6b-9eb6cdd3ef56
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb3145bb-0a7f-4fdc-bfb4-8eef604b8763
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6af9cfee-7400-45d9-971b-83e9bef3646c
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 279a17ec-87e2-425d-b6ad-68a4e838f5e3
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by historical sales
        name: PRODUCT_RANK_BY_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6af9cfee-7400-45d9-971b-83e9bef3646c
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: RANK() OVER (ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec6781e1-3a44-4ca5-93f0-b73fd0fbe25c
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product in category by historical sales
        name: PRODUCT_RANK_BY_SALES_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6af9cfee-7400-45d9-971b-83e9bef3646c
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: RANK() OVER (PARTITION BY stage_products.categoryid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd4d9691-4f51-45a7-bbe5-b4c5a62680f6
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by supplier by historical sales
        name: PRODUCT_RANK_BY_SALES_SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6af9cfee-7400-45d9-971b-83e9bef3646c
                stepCounter: f976db42-7096-4b31-af40-ebd22b1f81e8
            transform: RANK() OVER (PARTITION BY stage_products.supplierid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c66262fc-a06e-4ff5-bad3-b1ca7644241c
          stepCounter: 48721eb8-6d09-4293-81fa-8143ffb946e2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_PRODUCTS: f976db42-7096-4b31-af40-ebd22b1f81e8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGE_PRODUCTS
        join:
          joinCondition: FROM {{ ref('STAGE','STAGE_PRODUCTS') }}
        name: STAGE_PRODUCTS_RANK
        noLinkRefs: []
  name: STAGE_PRODUCTS_RANK
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
