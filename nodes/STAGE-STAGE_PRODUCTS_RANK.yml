fileVersion: 1
id: 1de92c36-49c2-440d-9681-a84cdb8f73e9
name: STAGE_PRODUCTS_RANK
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Applies business transforms - specifically Ranking transforms based on sales amounts."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0ef3ac4-fb59-4ad3-8047-19099ddf247e
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: INT
        defaultValue: ""
        description: Product ID
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5eae58c6-cfac-43fa-8eef-886645280800
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1994626a-c60f-40f1-a9a2-c3fa2eca3a25
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: This is the primary market product name
        name: PRODUCTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09dcfe25-2720-45ec-9f1c-d60a3013b552
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58cfab9e-42eb-4c6e-90d3-12ed8e7cd2f2
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63b45259-fd16-4dfa-9ae6-ffc4f9a3fa51
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea503a29-0a3e-45f2-9567-0f498f5bfac2
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: Supplier Name
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 063c2d45-ad9f-4b86-9d46-917794ad0d27
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d39243d7-71bb-4078-a412-9636ea927ecd
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: Supplier country of HQ
        name: SUPPLIER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec2f8cc6-27ad-4d50-85c6-01bb727aea86
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af73ea9c-c25c-4b71-8725-9aa046d7c9a6
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 446d4014-4d99-455e-a058-21d13fd4e82f
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf975567-9d6c-40c5-9555-944f5e6df120
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: The product marketing category
        name: CATEGORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ff87eed-94d8-4882-aca5-777d2b7273f5
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54ba63c1-310c-458f-95d9-cbbaa200170d
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: QUANTITYPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bed9cad6-463a-474c-b5e6-2f5ac131c1f3
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d2ac4b5-9796-48fe-9bc2-16a5deab7abd
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: UNITPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 643baa91-4fa7-4508-9aff-b534315e109e
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71ee8587-a036-43f6-899d-a311369db18f
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PRODUCTSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bdeb5ba-823a-456d-8def-c9fc2abf213d
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c9e1da8-32b5-43a1-8fdd-c4aef3426ab1
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by historical sales
        name: PRODUCT_RANK_BY_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bdeb5ba-823a-456d-8def-c9fc2abf213d
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: RANK() OVER (ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 413fad94-7a20-4e9b-94d4-ad023fe11d8e
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product in category by historical sales
        name: PRODUCT_RANK_BY_SALES_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bdeb5ba-823a-456d-8def-c9fc2abf213d
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: RANK() OVER (PARTITION BY stage_products.categoryid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f40081aa-d9a6-4a22-9e9b-d91ed71ca271
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: INT
        defaultValue: ""
        description: Overall rank of product by supplier by historical sales
        name: PRODUCT_RANK_BY_SALES_SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bdeb5ba-823a-456d-8def-c9fc2abf213d
                stepCounter: 27e5a621-d4cb-4009-8173-5324e5c06344
            transform: RANK() OVER (PARTITION BY stage_products.supplierid ORDER BY stage_products.productsales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8067591c-a9df-410b-a854-c043096645ee
          stepCounter: 1de92c36-49c2-440d-9681-a84cdb8f73e9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_PRODUCTS: 27e5a621-d4cb-4009-8173-5324e5c06344
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGE_PRODUCTS
        join:
          joinCondition: FROM {{ ref('STAGE','STAGE_PRODUCTS') }}
        name: STAGE_PRODUCTS_RANK
        noLinkRefs: []
  name: STAGE_PRODUCTS_RANK
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
