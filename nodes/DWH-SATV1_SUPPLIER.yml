fileVersion: 1
id: 4cd295f1-cc14-46ac-914b-28098d1acc24
name: SATV1_SUPPLIER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f6485ee-abab-45f5-a0e6-9c68a9ccd2ec
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 300db70e-91e3-4b52-ba1d-ad819787cb5b
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 244e5632-f3e8-4d91-a5da-5623ad7f9aca
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cbca9b1-3f8c-4c80-a959-f504259f125f
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c4b09a8-abf2-4dcb-a2fa-aed6202abede
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b28d0746-31a8-4a4a-aef6-5db5af8a3745
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c046a389-faa6-44f4-a81a-de337c61db33
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a0b4e10-8008-4d79-a1ca-b6384de36475
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80bdc9de-f1dc-4d37-96ff-3e89b350bb48
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32dd9649-519d-43e7-befa-f7f4ed94e2cf
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 208241c3-9c37-4eaa-b450-10963f9c5c66
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e4a41a3-20c2-4435-969e-951babd18568
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f0c086b-811c-4c12-bd94-3b09f19d8d43
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92bdd969-5cab-4111-87ec-24c48fe682fa
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a22da9a-aa49-4614-a1ad-9965198bb93f
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca5746eb-32bf-4fc0-ac39-f633cb34d860
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c9562a12-cb3b-4a16-918b-81559f04d028
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74a9db50-e462-46f4-bf25-516d6c9203ba
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2a5836a-38f1-45df-b119-1519f1d1bd66
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: acaeb205-45b0-411e-a48f-86d8945cc3e1
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e8066ad-7876-4a64-aaf2-47676b4d65fb
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00a65aba-4eec-4548-9c1f-17a84638d3b0
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f7567bb-a4da-44b7-8ba3-0334e421f9aa
          stepCounter: 4cd295f1-cc14-46ac-914b-28098d1acc24
        config: {}
        dataType: STRING
        description: ""
        name: S_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d04ac25c-8df6-40b6-a6ce-84c8cd080437
                stepCounter: afca9e7e-18ee-4bed-bb0a-fe283171b8c0
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_SUPPLIER
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_SUPPLIER') }} "SATV0_SUPPLIER"
        name: SATV1_SUPPLIER
        noLinkRefs: []
  name: SATV1_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: DV2:::9
  type: sql
  version: 1
type: Node
