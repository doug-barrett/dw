fileVersion: 1
id: b9c97e92-cef1-4044-99fd-aacd1fd519da
name: SATV1_SUPPLIER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: Supplier data as defined by TPC-H
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c20ca6a-fc0e-44b8-8931-177e09f08290
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40251517-cc30-4b7f-a1ac-7da4967ca4e9
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19579e60-f144-4b49-b931-06e10d701950
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86d0125f-3700-4dea-985a-b2ea86dd61b8
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ec0ec8e-17c2-4123-8a27-ea5137799121
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02b193e5-d6aa-4bf6-ab0b-659d696ee14d
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b63177d-085f-47f1-aed0-01519fc711c8
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4734f230-b71e-459e-b091-69503016a3e0
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba691741-013a-48bf-8f1f-ee203b40cee2
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1c30c54-4295-476b-9bd6-171dcc6fffeb
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6250f1c7-bd75-467b-896d-d688cad2c34c
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f450bf2d-f53c-4b77-bcbd-fcc7352166f7
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f44295b-ff73-4c75-a73d-16614cadf254
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fa11358-773c-4d73-a7f9-16e8c76ab255
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04e5e0e2-bfe9-403c-91ae-74093719319d
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de20a32b-b151-42e1-ac90-f1bdaf81866b
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bdac5a5-229d-41d6-8310-9f5b182a25c1
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a8cb418-e01c-4ced-b770-2d97f51f1213
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 04fd625b-3f38-4445-85cc-49377edf3f04
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcc4db84-1672-4156-a9fc-d02054498357
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e04e9efe-1a44-48cc-af5a-7eea3f7eff5a
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef73ead9-df77-4f3f-91ce-238165c1d438
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: STRING
        description: ""
        name: S_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6175a9c-639e-43a9-9c23-03c2ad7b9622
                stepCounter: 57b86d76-b0d2-440d-9114-e1efdc197f06
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 931afb42-023b-4159-9432-b3b88497d996
          stepCounter: b9c97e92-cef1-4044-99fd-aacd1fd519da
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_SUPPLIER
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_SUPPLIER') }} "SATV0_SUPPLIER"
        name: SATV1_SUPPLIER
        noLinkRefs: []
  name: SATV1_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: "9"
  type: sql
  version: 1
type: Node
