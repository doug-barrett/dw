fileVersion: 1
id: 106cb041-8bf6-4781-af50-771b40089311
name: SATV1_SUPPLIER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: Supplier data as defined by TPC-H
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14263550-b8e7-4006-97f2-ba64a084146d
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7651365c-9186-48cd-bb74-6a8ad899b522
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0017d46-786b-4e70-8a01-f24b81a694ff
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0165955e-192f-43e4-8b8b-bf3ad3fe4266
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22f8f676-db4e-4ac6-8007-93a79fe77d81
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 361cf1e7-b422-4385-98a5-0a659a2c9abd
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b21c4f7-f2aa-4cf7-a1e0-0cb8723d3e96
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d927777c-0652-498f-a802-2e9efc1cc7e8
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0e989dd-60de-4250-95e7-54f201f54ec5
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b74392de-f4ff-43cc-9b1b-211487f0b9b7
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88d4826c-5950-4c89-8008-b2dcbbc4c9d5
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dab99017-21e0-455e-8cbb-abef029c05c4
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e2ab289-e56e-4f07-acaa-cef2de59661f
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09e4577f-2f4a-4593-b0bc-e697660e2b8b
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78a6ff8a-52b1-405d-82bd-52f2853ecd9d
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9691b4a8-33dd-48c9-844e-c2e0abccef0d
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebce7132-104e-479a-9375-53abf21796a3
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: STRING
        description: ""
        name: S_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f202bfa-71b5-4e8d-82b2-31bafdd868af
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f339b6b0-e248-4331-86b1-cd1be8916e6a
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08a84c21-ba19-4b6b-98e7-afd52d9840f1
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7171c1b7-2b47-4937-863e-d425344ebd4c
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 192bc980-d531-4169-aeef-1a341477272a
                stepCounter: 2a5962d7-8761-411c-a5c4-4a9e5410130d
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f7bfe0e0-68e9-4ef3-84ba-649ce2b13485
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1d10edce-091c-40d6-963d-63d9a8930a19
          stepCounter: 106cb041-8bf6-4781-af50-771b40089311
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_SUPPLIER
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_SUPPLIER') }} "SATV0_SUPPLIER"
        name: SATV1_SUPPLIER
        noLinkRefs: []
  name: SATV1_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: DV:::9
  type: sql
  version: 1
type: Node
