fileVersion: 1
id: b53cd57b-bf04-4824-8813-a45f82ae0ddf
name: SATV1_SUPPLIER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: Supplier data as defined by TPC-H
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5f10cf8-cb3c-4245-8722-a9373c483474
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7558f7ee-56f5-47ae-ad9d-db38ea271f3d
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69193079-ebea-4cb4-9ada-b274760eb5d6
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91abcbc6-cb01-447c-b8f0-353c7b2461bb
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee058778-560d-4196-ba3f-daacfbeb9af8
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2946aba-1ade-4f36-a11f-a0589da0ef92
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 040218d4-5f25-4753-b140-2a6a82c75906
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34baceca-ddfc-489a-9969-f9a86993f96d
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee468139-707a-4650-bdfd-d2792e5fa78e
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 506f300d-28a7-4dec-b956-6f30e2acb7d9
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e4a9909-c38a-488b-8884-a1f60c7d5089
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2a3b324-3c20-412f-9abd-926253bf1357
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32aa0dec-0bb1-4fa1-a647-eb46518abf94
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 641b7e8b-ea7b-4b1b-9a66-770a6bc8f66c
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f75187e3-0c36-48a1-9774-f33a0fe92d1c
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0c3679e-9f5a-447d-add1-fed14506c204
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61f78a92-24ed-46c0-8aa0-0bd5ac4a04e9
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11876a25-3b86-4142-95cc-65ab541bed40
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a7b4d6a0-dc49-4d0f-b9d6-c1f3322e4aed
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 128a54a5-46da-4fe6-9631-a0530f15422b
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a99f024e-104a-4dc0-b15b-c003a48ebc1b
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 284d3f8f-6d79-40bd-8df4-0ce74bc46f83
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: STRING
        description: ""
        name: S_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52d6d935-6e0a-40ab-82cd-0f59945e65b8
                stepCounter: 3d9c5828-7856-4351-b5ad-d7090afd8726
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 898ac4e5-ee4a-4289-b9bc-d144e140d632
          stepCounter: b53cd57b-bf04-4824-8813-a45f82ae0ddf
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_SUPPLIER
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_SUPPLIER') }} "SATV0_SUPPLIER"
        name: SATV1_SUPPLIER
        noLinkRefs: []
  name: SATV1_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: DV:::9
  type: sql
  version: 1
type: Node
