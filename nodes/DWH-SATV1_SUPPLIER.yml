fileVersion: 1
id: 6cf1b8ea-8d14-4275-b365-734e47349ade
name: SATV1_SUPPLIER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b63d36f8-28db-4d7b-aa6c-5f81c7324f8a
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f793922-ad94-414c-a3d9-b8a6e3866812
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25123665-c1ee-4558-b746-7e9d44c89b91
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb1ba762-794f-48fb-aa57-20d3ac8d3e16
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0aa73043-3a75-4737-8b66-a97150bf3d76
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09e7b986-6af5-4ebd-8133-883df2f9d4b6
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60dc99cb-6983-43e4-bc93-583920ad1c28
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11862cd2-f32b-4050-a216-69970dfd8671
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c655f156-9e97-4c53-9cde-80d995a44f64
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 747a4c73-138c-49bf-b835-1bdd00446e42
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c6721c7-2470-4f29-a87d-1c9b3e58b11a
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ed02dd4-1a22-458e-8477-52e5e0867962
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17e3a37a-cd99-4a87-a59d-4e0edaa20d24
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13a58398-5d7c-4c10-bc55-99381d8630a5
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25ada833-f4d6-4fa1-b43d-ab262ae05c78
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee572322-aec7-4dca-8e70-84854b11efd3
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b1528c0-e871-4c3d-8ccd-72775dc4f0b2
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddbce133-c4d3-4319-8593-8f796afe17cd
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: be42c628-9b87-4a53-9ce8-caeff09c590c
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca1d28c9-1e00-4fb7-9102-78df5579c733
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ff95aca-d663-4488-90bf-90b56efda8ed
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc5373d0-a90a-4a11-9912-fdf20c446da9
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: STRING
        description: ""
        name: S_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b585ce2-d298-4e04-b690-d2084225b964
                stepCounter: 85bd2dc8-d975-43a3-adee-b0eb39c0fb67
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 894daabb-32f4-4b7c-92fe-5b05f8b54e9c
          stepCounter: 6cf1b8ea-8d14-4275-b365-734e47349ade
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_SUPPLIER
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_SUPPLIER') }} "SATV0_SUPPLIER"
        name: SATV1_SUPPLIER
        noLinkRefs: []
  name: SATV1_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: DV2:::9
  type: sql
  version: 1
type: Node
