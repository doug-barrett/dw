fileVersion: 1
id: b5821229-0cf0-47da-a8c1-ab53ea830771
name: SATV1_SUPPLIER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: Supplier data as defined by TPC-H
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e58dbe7-5d2b-4bfc-87b1-0d0d9b216c7d
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: H_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1d7683a-a93e-491d-a595-83da741ab898
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e16ac9d-58a7-4bec-90f1-9cc5e61b448e
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9e6132c-96ce-41c6-a380-f27d14087af2
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c88cfc2-0f58-4181-b287-1d263805ff2d
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: S_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41cf84ae-e972-4aea-8820-a15bbac0621a
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 403a15f1-15fc-400c-a04f-939fb23419e3
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bafd0bd-7cac-433e-afad-f25a5faaecfe
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abbfd339-2791-4816-9f0b-9789bbfcea74
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: S_NATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e33638cc-c04b-4d4e-be1d-8b5b91cb528f
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3008829-fdd4-44ce-a74f-8e800d3066f2
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: S_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8a858c0-68e9-4f0e-9dd2-5a07418850b7
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31d3a2d2-4079-40ce-a28c-a695baea52ce
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: S_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 824c45c4-7a2d-4da2-b149-a700f9b53af6
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5230985c-3b38-4896-9e65-16eba14b869c
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: VARCHAR(101)
        description: ""
        name: S_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f0e2219-09ac-42a9-ad60-26ebbf677c31
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e018eeba-d3a5-4b22-96e6-fb39d8a0cb86
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7530dee-4a16-46e9-a9f3-411a6e5da2b4
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b1690aef-7aea-4771-b456-6d6774e41380
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c6f722e8-f4f1-400d-93f9-76ab297f54d6
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eebcb138-7ecf-450c-8442-8c60b599fcfb
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd783dbe-7695-4f7f-8a21-367ffea1cb72
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 889ed256-9d44-4c8a-b0ba-e4f2f73601d3
          stepCounter: b5821229-0cf0-47da-a8c1-ab53ea830771
        config: {}
        dataType: STRING
        description: ""
        name: S_SUPPLIER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bb2e0bb-6bb8-436b-819b-848537e1c22a
                stepCounter: 4ce89239-fc4c-4532-a0e9-468c0bb563b9
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_SUPPLIER
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_SUPPLIER') }} "SATV0_SUPPLIER"
        name: SATV1_SUPPLIER
        noLinkRefs: []
  name: SATV1_SUPPLIER
  overrideSQL: false
  schema: ""
  sqlType: DV:::9
  type: sql
  version: 1
type: Node
