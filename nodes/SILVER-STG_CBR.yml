fileVersion: 1
id: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
name: STG_CBR
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Created before records with row numbering
  isMultisource: false
  locationName: SILVER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 519a53b2-a39b-4e52-918b-fd610c44bfe1
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: DATE
        description: ""
        name: DAY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 519a53b2-a39b-4e52-918b-fd610c44bfe1
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"DAY_DATE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26b51a18-e4cd-44d1-b514-3052287f25e4
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: SALES_TEAM_REPORTING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26b51a18-e4cd-44d1-b514-3052287f25e4
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"SALES_TEAM_REPORTING\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8822bdea-257f-4d14-9a36-fc2e6ede0706
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8822bdea-257f-4d14-9a36-fc2e6ede0706
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"ID\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 107b409b-b110-4476-b2fb-574fe5c471f3
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 107b409b-b110-4476-b2fb-574fe5c471f3
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"ACCOUNT_ID\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fddfb38-50f6-45a2-be29-e993848dcf2a
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fddfb38-50f6-45a2-be29-e993848dcf2a
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"CREATED_DATE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 535352a4-91a9-4352-827b-1f03c5d59b2e
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: DATE
        description: ""
        name: CLOSE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 535352a4-91a9-4352-827b-1f03c5d59b2e
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"CLOSE_DATE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5c94724-eecc-4e25-8dbb-c1518d0260ae
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5c94724-eecc-4e25-8dbb-c1518d0260ae
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"NAME\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 343bdd19-2724-44d1-b270-4d72af4b5b2a
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: NUMBER
        description: ""
        name: NET_NEW_ACV
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 343bdd19-2724-44d1-b270-4d72af4b5b2a
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"NET_NEW_ACV\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d16e98a9-3f75-4efd-871c-35bea10caf87
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: STAGE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d16e98a9-3f75-4efd-871c-35bea10caf87
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"STAGE_NAME\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97f84303-7b72-4c58-86d2-8bdddfd92617
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: OWNER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97f84303-7b72-4c58-86d2-8bdddfd92617
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"OWNER_ID\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39c195c5-00ed-418c-9a8b-490e0d4cb876
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: SALES_TEAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39c195c5-00ed-418c-9a8b-490e0d4cb876
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"SALES_TEAM\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 934daad4-5207-4162-ab94-01a16ea84aea
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: PRM_PARTNER_LEVEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 934daad4-5207-4162-ab94-01a16ea84aea
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"PRM_PARTNER_LEVEL\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecd4694b-c519-41e1-8dd2-b470b4b57ce3
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: DBT_VALID_FROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecd4694b-c519-41e1-8dd2-b470b4b57ce3
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"DBT_VALID_FROM\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7e61916-b4d2-4f0e-a68f-848f662b9f12
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: DBT_VALID_TO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7e61916-b4d2-4f0e-a68f-848f662b9f12
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"DBT_VALID_TO\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a473f8e-bed1-463d-9806-1688c1a8248e
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: MULTI_YEAR_SUBSCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a473f8e-bed1-463d-9806-1688c1a8248e
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"MULTI_YEAR_SUBSCRIPTION\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e68a7065-cffa-41ae-b361-b7b7d2293a37
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: TERRITORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e68a7065-cffa-41ae-b361-b7b7d2293a37
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"TERRITORY\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73da530d-c79d-4e4e-8b64-7cb94be2261b
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73da530d-c79d-4e4e-8b64-7cb94be2261b
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"PARTNER_TYPE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7fb9ac3-5668-4012-b749-36581e7451f6
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: OPPORTUNITY_OWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7fb9ac3-5668-4012-b749-36581e7451f6
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"OPPORTUNITY_OWNER\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af0a4274-9e99-4dc8-9a6e-e1a76614cd58
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: SUB_TEAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af0a4274-9e99-4dc8-9a6e-e1a76614cd58
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"SUB_TEAM\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af14bce0-a572-48a3-bcb6-d6490b9eaf8e
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: USER_ROLE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af14bce0-a572-48a3-bcb6-d6490b9eaf8e
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"USER_ROLE_ID\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e86d1b56-8cfd-435a-bdb4-46e3384d2e8a
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: VARCHAR
        description: ""
        name: OWNER_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e86d1b56-8cfd-435a-bdb4-46e3384d2e8a
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"OWNER_ROLE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95bfd040-5a76-435d-a2bc-c453d2e808ce
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: VALID_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95bfd040-5a76-435d-a2bc-c453d2e808ce
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: "\"VALID_DATE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0f672b6-997a-456c-93c3-3b5f2c23f341
          stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
        config: {}
        dataType: NUMBER
        description: ""
        name: ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0f672b6-997a-456c-93c3-3b5f2c23f341
                stepCounter: 5d33d9a2-15a4-4ec6-9f18-b703000ceb19
            transform: ROW_NUMBER() OVER (PARTITION BY "ID","DAY_DATE" ORDER BY "DBT_VALID_FROM", "STAGE_NAME" DESC)
    cteString: ""
    description: ""
    destinationName: ""
    enabledColumnTestIDs: []
    materializationOption: ""
    sourceMapping:
      - aliases:
          STG_EXPANDED_DAYS: 77888b25-868e-4bf1-a7e3-89361ec3a98f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SILVER
            nodeName: STG_CREATED_BEFORE
          - locationName: SILVER
            nodeName: STG_EXPANDED_DAYS
        join:
          joinCondition: |-
            FROM {{ ref('SILVER', 'STG_EXPANDED_DAYS') }} "STG_EXPANDED_DAYS"
            WHERE CONCAT("ID","DAY_DATE") IN (
                SELECT CONCAT("ID","DAY_DATE") 
                FROM {{ ref('SILVER', 'STG_CREATED_BEFORE') }} "STG_CREATED_BEFORE"
            )
        name: STG_EXPANDED_DAYS_CREATED_BEFORE
        noLinkRefs: []
  name: STG_CBR
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
